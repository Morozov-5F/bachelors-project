(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    119891,       3626]
NotebookOptionsPosition[    117795,       3554]
NotebookOutlinePosition[    118153,       3570]
CellTagsIndexPosition[    118110,       3567]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"variables", " ", "=", " ", 
   RowBox[{"Sort", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["\[Alpha]", 
          RowBox[{"i", ",", "j"}]], ",", " ", 
         SubscriptBox["\[Beta]", 
          RowBox[{"i", ",", "j"}]], ",", " ", 
         SubscriptBox["\[Gamma]", 
          RowBox[{"i", ",", "j"}]], ",", " ", 
         SubscriptBox["\[Sigma]", 
          RowBox[{"i", ",", "j"}]]}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "1", ",", " ", "3"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"j", ",", " ", "1", ",", " ", "2"}], "}"}]}], "]"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"transformSubstitutions", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           SubscriptBox["A", "i"], " ", "\[Rule]", " ", 
           RowBox[{
            SubscriptBox["a", 
             RowBox[{"i", ",", "1"}]], " ", "+", " ", 
            RowBox[{"I", " ", "*", " ", 
             SubscriptBox["a", 
              RowBox[{"i", ",", "2"}]]}]}]}], ",", " ", 
          RowBox[{
           SubscriptBox["B", "i"], " ", "\[Rule]", " ", 
           RowBox[{
            SubscriptBox["b", 
             RowBox[{"i", ",", "1"}]], " ", "+", " ", 
            RowBox[{"I", " ", "*", " ", 
             SubscriptBox["b", 
              RowBox[{"i", ",", "2"}]]}]}]}], ",", " ", 
          RowBox[{
           SubscriptBox["C", "i"], " ", "\[Rule]", " ", 
           RowBox[{
            SubscriptBox["c", 
             RowBox[{"i", ",", "1"}]], " ", "+", " ", 
            RowBox[{"I", " ", "*", " ", 
             SubscriptBox["c", 
              RowBox[{"i", ",", "2"}]]}]}]}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", " ", 
      RowBox[{
       SubscriptBox["z", "1"], "\[Rule]", 
       RowBox[{
        SubscriptBox["x", "1"], "+", 
        RowBox[{"I", "*", 
         SubscriptBox["y", "1"]}]}]}], ",", " ", 
      RowBox[{
       SubscriptBox["z", "2"], "\[Rule]", 
       RowBox[{
        SubscriptBox["x", "2"], "+", 
        RowBox[{"I", "*", 
         SubscriptBox["y", "2"]}]}]}], ",", " ", 
      RowBox[{"w", "\[Rule]", 
       RowBox[{"u", "+", 
        RowBox[{"I", "*", "v"}]}]}], ",", " ", 
      RowBox[{
       SubscriptBox["P", "1"], "\[Rule]", 
       RowBox[{
        SubscriptBox["p", 
         RowBox[{"1", ",", "1"}]], "+", 
        RowBox[{"I", "*", 
         SubscriptBox["p", 
          RowBox[{"1", ",", "2"}]]}]}]}], ",", " ", 
      RowBox[{
       SubscriptBox["P", "2"], "\[Rule]", 
       RowBox[{
        SubscriptBox["p", 
         RowBox[{"2", ",", "1"}]], "+", 
        RowBox[{"I", "*", 
         SubscriptBox["p", 
          RowBox[{"2", ",", "2"}]]}]}]}], ",", " ", 
      RowBox[{"q", "\[Rule]", 
       RowBox[{
        SubscriptBox["q", "1"], "+", 
        RowBox[{"I", "*", 
         SubscriptBox["q", "2"]}]}]}]}], "}"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"parameterSubstitutions", "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            SubscriptBox["a", 
             RowBox[{"i", ",", "j"}]], " ", "\[Rule]", " ", 
            RowBox[{
             SubscriptBox["a", 
              RowBox[{"i", ",", "j"}]], "[", "t", "]"}]}], ",", " ", 
           RowBox[{
            SubscriptBox["b", 
             RowBox[{"i", ",", "j"}]], " ", "\[Rule]", " ", 
            RowBox[{
             SubscriptBox["b", 
              RowBox[{"i", ",", "j"}]], "[", "t", "]"}]}], ",", " ", 
           RowBox[{
            SubscriptBox["c", 
             RowBox[{"i", ",", "j"}]], " ", "\[Rule]", " ", 
            RowBox[{
             SubscriptBox["c", 
              RowBox[{"i", ",", "j"}]], "[", "t", "]"}]}]}], "}"}], ",", " ", 
         
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "1", ",", " ", "3"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"j", ",", " ", "1", ",", " ", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["p", 
           RowBox[{"i", ",", "j", " "}]], "\[Rule]", " ", 
          RowBox[{
           SubscriptBox["p", 
            RowBox[{"i", ",", "j"}]], "[", "t", "]"}]}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "1", ",", " ", "2"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"j", ",", " ", "1", ",", " ", "2"}], "}"}]}], "]"}], ",", 
       " ", 
       RowBox[{
        SubscriptBox["q", "1"], " ", "\[Rule]", " ", 
        RowBox[{
         SubscriptBox["q", "1"], "[", "t", "]"}]}], ",", " ", 
       RowBox[{
        SubscriptBox["q", "2"], " ", "\[Rule]", " ", 
        RowBox[{
         SubscriptBox["q", "2"], "[", "t", "]"}]}]}], "}"}], "]"}]}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"diffSubstitution", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             SubscriptBox["a", 
              RowBox[{"i", ",", "j"}]], "'"}], "[", "0", "]"}], " ", 
           "\[Rule]", " ", 
           SubscriptBox["\[Alpha]", 
            RowBox[{"i", ",", "j"}]]}], ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             SubscriptBox["b", 
              RowBox[{"i", ",", "j"}]], "'"}], "[", "0", "]"}], " ", 
           "\[Rule]", " ", 
           SubscriptBox["\[Beta]", 
            RowBox[{"i", ",", "j"}]]}], ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             SubscriptBox["c", 
              RowBox[{"i", ",", "j"}]], "'"}], "[", "0", "]"}], " ", 
           "\[Rule]", " ", 
           SubscriptBox["\[Gamma]", 
            RowBox[{"i", ",", "j"}]]}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", "3"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"j", ",", " ", "1", ",", " ", "2"}], "}"}]}], "]"}], ",", 
      " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           SubscriptBox["p", 
            RowBox[{"i", ",", "j"}]], "'"}], "[", "0", "]"}], " ", "\[Rule]", 
         " ", 
         SubscriptBox["\[Sigma]", 
          RowBox[{"i", ",", "j"}]]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", "2"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"j", ",", " ", "1", ",", " ", "2"}], "}"}]}], "]"}], ",", 
      " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           SubscriptBox["q", "1"], "'"}], "[", "0", "]"}], " ", "\[Rule]", 
         " ", 
         SubscriptBox["\[Sigma]", 
          RowBox[{"3", ",", "1"}]]}], ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           SubscriptBox["q", "2"], "'"}], "[", "0", "]"}], " ", "\[Rule]", 
         " ", 
         SubscriptBox["\[Sigma]", 
          RowBox[{"3", ",", "2"}]]}]}], "}"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["Z", "1"], "[", "AT_", "]"}], ":=", 
  RowBox[{"First", "@", 
   RowBox[{"AT", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{
   SubscriptBox["Z", "2"], "[", "AT_", "]"}], ":=", 
  RowBox[{"First", "@", 
   RowBox[{"AT", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"W", "[", "AT_", "]"}], ":=", 
  RowBox[{"First", "@", 
   RowBox[{"AT", "[", 
    RowBox[{"[", "3", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CreateTransform", "[", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "at", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"at", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["A", "1"], ",", 
              SubscriptBox["A", "2"], ",", 
              SubscriptBox["A", "3"]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["B", "1"], ",", 
              SubscriptBox["B", "2"], ",", 
              SubscriptBox["B", "3"]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["C", "1"], ",", 
              SubscriptBox["C", "2"], ",", 
              SubscriptBox["C", "3"]}], "}"}]}], "}"}], ")"}], ".", 
         "\[IndentingNewLine]", 
         RowBox[{"(", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             SubscriptBox["z", "1"], "}"}], ",", 
            RowBox[{"{", 
             SubscriptBox["z", "2"], "}"}], ",", 
            RowBox[{"{", "w", "}"}]}], "}"}], ")"}]}], "+", 
        RowBox[{"(", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            SubscriptBox["P", "1"], "}"}], ",", 
           RowBox[{"{", 
            SubscriptBox["P", "2"], "}"}], ",", 
           RowBox[{"{", "q", "}"}]}], "}"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"at", " ", "=", " ", 
       RowBox[{"at", "/.", "transformSubstitutions"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Expand", "@", "at"}]}]}], "\[IndentingNewLine]", "]"}]}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "\:041f\:0440\:0438\:043c\:0435\:043d\:044f\:0435\:0442", " ", 
    "\:0430\:0444\:0444\:0438\:043d\:043d\:043e\:0435", " ", 
    "\:043f\:0440\:0435\:043e\:0431\:0440\:0430\:0437\:043e\:0432\:0430\:043d\
\:0438\:0435", " ", "\:043a", " ", 
    "\:043f\:043e\:0432\:0435\:0440\:0445\:043d\:043e\:0441\:0442\:0438"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TransformSurface", "[", 
   RowBox[{"surface_", ",", " ", "transform_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"s", " ", "=", " ", "surface"}], ",", " ", "st", ",", 
      RowBox[{"tr", " ", "=", " ", "transform"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"st", " ", "=", " ", 
      RowBox[{"s", " ", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          SubscriptBox["x", "1"], "\[Rule]", 
          RowBox[{"ComplexExpand", "@", 
           RowBox[{"Re", "@", 
            RowBox[{
             SubscriptBox["Z", "1"], "@", "tr"}]}]}]}], ",", " ", 
         RowBox[{
          SubscriptBox["y", "1"], "\[Rule]", 
          RowBox[{"ComplexExpand", "@", 
           RowBox[{"Im", "@", 
            RowBox[{
             SubscriptBox["Z", "1"], "@", "tr"}]}]}]}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          SubscriptBox["x", "2"], "\[Rule]", " ", 
          RowBox[{"ComplexExpand", "@", 
           RowBox[{"Re", "@", 
            RowBox[{
             SubscriptBox["Z", "2"], "@", "tr"}]}]}]}], ",", " ", 
         RowBox[{
          SubscriptBox["y", "2"], "\[Rule]", 
          RowBox[{"ComplexExpand", "@", 
           RowBox[{"Im", "@", 
            RowBox[{
             SubscriptBox["Z", "2"], "@", "tr"}]}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"u", "\[Rule]", 
          RowBox[{"ComplexExpand", "@", 
           RowBox[{"Re", "@", 
            RowBox[{"W", "@", "tr"}]}]}]}], ",", 
         RowBox[{"v", "\[Rule]", 
          RowBox[{"ComplexExpand", "@", 
           RowBox[{"Im", "@", 
            RowBox[{"W", "@", "tr"}]}]}]}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", "st"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetSystem", "[", "surface_", "]"}], ":=", "\[IndentingNewLine]", 
    
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s", "=", "surface"}], ",", 
        RowBox[{"system", " ", "=", " ", 
         RowBox[{"{", "}"}]}], ",", " ", 
        RowBox[{"\[CapitalPhi]", "=", 
         RowBox[{"Subtract", "@@", "surface"}]}], ",", "ts", ",", 
        RowBox[{"vars", "=", 
         RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vars", " ", "=", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["x", "1"], ",", 
          SubscriptBox["x", "2"], ",", 
          SubscriptBox["y", "1"], ",", 
          SubscriptBox["y", "2"], ",", "u", ",", "v"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ts", " ", "=", " ", 
        RowBox[{
         RowBox[{"TransformSurface", "[", 
          RowBox[{"\[CapitalPhi]", ",", " ", 
           RowBox[{"CreateTransform", "[", "]"}]}], "]"}], "/.", 
         "parameterSubstitutions"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ts", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"ts", ",", " ", "t"}], "]"}], "/.", 
          RowBox[{"t", "\[Rule]", "0"}]}], "/.", "diffSubstitution"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ts", "=", 
        RowBox[{"Expand", "[", 
         RowBox[{"(", 
          RowBox[{"ts", "/.", 
           RowBox[{
            RowBox[{"Solve", "[", 
             RowBox[{"s", ",", "v"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ts", " ", "*=", " ", 
        RowBox[{"Denominator", "@", 
         RowBox[{"Simplify", "@", "ts"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ts", "=", 
        RowBox[{"Simplify", "@", "ts"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"system", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Times", " ", "@@", " ", 
            RowBox[{"(", 
             RowBox[{"vars", "^", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "\[Rule]", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "&"}], "/@", 
         RowBox[{"CoefficientRules", "[", 
          RowBox[{"ts", ",", " ", "vars"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"system", " ", "=", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"system", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", " ", "2"}], "]"}], "]"}], ",", "0"}], "]"}]}],
        ";", "\[IndentingNewLine]", "system"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "\:041f\:0440\:0438\:0432\:043e\:0434\:0438\:0442", " ", 
    "\:043c\:0430\:0442\:0440\:0438\:0446\:0443", " ", "\:043a", " ", 
    "\:0441\:0442\:0443\:043f\:0435\:043d\:0447\:0430\:0442\:043e\:043c\:0443\
", " ", "\:0432\:0438\:0434\:0443", " ", "\:0441", " ", 
    "\:0443\:0447\:0435\:0442\:043e\:043c", " ", 
    "\:043f\:0440\:0435\:0434\:043f\:043e\:043b\:043e\:0436\:0435\:043d\:0438\
\:0439"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AdaptiveElmination", "[", 
     RowBox[{"matrix_", ",", " ", "variables_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"m", "=", "matrix"}], ",", 
        RowBox[{"perms", " ", "=", " ", 
         RowBox[{"{", "}"}]}], ",", " ", 
        RowBox[{"dim", " ", "=", " ", 
         RowBox[{"Dimensions", "@", "matrix"}]}], ",", "\[IndentingNewLine]", 
        
        RowBox[{"h", " ", "=", " ", 
         RowBox[{"Dimensions", "@", 
          RowBox[{"matrix", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], ",", " ", 
        RowBox[{"w", " ", "=", " ", 
         RowBox[{"Dimensions", "@", 
          RowBox[{"matrix", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], ",", "pos", ",", "i", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"vars", " ", "=", " ", 
         RowBox[{"Flatten", "@", 
          RowBox[{"{", "variables", "}"}]}]}], ",", "pattern"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pattern", " ", "=", " ", 
        RowBox[{"Except", "[", 
         RowBox[{"0", ",", "\[IndentingNewLine]", 
          RowBox[{"_Integer", "|", 
           RowBox[{"_", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Variables", "@", "#"}], " ", "===", " ", "vars"}], 
              "&"}], ")"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", " ", "=", " ", "1"}], ",", 
         RowBox[{"i", " ", "<", " ", 
          RowBox[{"Min", "[", 
           RowBox[{"w", ",", " ", "h"}], "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"pos", "=", 
           RowBox[{"Flatten", "@", 
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"m", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"i", ";;"}], ",", " ", 
                 RowBox[{"i", ";;"}]}], "]"}], "]"}], ",", " ", "pattern", 
              ",", " ", "2", ",", " ", "1"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"pos", " ", "===", " ", 
             RowBox[{"{", "}"}]}], ",", " ", 
            RowBox[{"Break", "[", "]"}], ",", 
            RowBox[{"pos", " ", "+=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "-", "1"}], ",", " ", 
               RowBox[{"i", "-", "1"}]}], "}"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"m", "[", 
            RowBox[{"[", 
             RowBox[{"{", 
              RowBox[{"i", ",", " ", 
               RowBox[{"pos", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}], "]"}], "=", 
           RowBox[{"m", "[", 
            RowBox[{"[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"pos", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", " ", "i"}], "}"}], "]"}],
             "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"m", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", " ", 
                RowBox[{"pos", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], "]"}], "=", 
           RowBox[{"m", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"pos", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", "i"}], "}"}]}], "]"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"m", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"i", "+", "1"}], ";;"}], "]"}], "]"}], "=", 
           RowBox[{"Factor", "@", 
            RowBox[{"MatrixReduceRow", "[", 
             RowBox[{"m", ",", " ", "i"}], "]"}]}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "m"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "  ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetInfinitesimalTransforms", "[", "system_", "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s", " ", "=", " ", "system"}], ",", " ", 
        RowBox[{"ta", "=", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"vars", " ", "=", " ", 
         RowBox[{"{", "}"}]}], ",", " ", 
        RowBox[{"basis", " ", "=", " ", 
         RowBox[{"{", "}"}]}], ",", " ", "sol", ",", " ", 
        RowBox[{"itm", " ", "=", " ", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"subs", " ", "=", " ", 
         RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vars", " ", "=", 
        RowBox[{"Sort", "@", 
         RowBox[{"Flatten", "@", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["\[Alpha]", 
               RowBox[{"i", ",", "j"}]], ",", " ", 
              SubscriptBox["\[Beta]", 
               RowBox[{"i", ",", "j"}]], ",", " ", 
              SubscriptBox["\[Gamma]", 
               RowBox[{"i", ",", "j"}]], ",", " ", 
              SubscriptBox["\[Sigma]", 
               RowBox[{"i", ",", "j"}]]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"i", ",", " ", "1", ",", " ", "3"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"j", ",", " ", "1", ",", " ", "2"}], "}"}]}], 
           "]"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"itm", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[Alpha]", 
                RowBox[{"i", ",", "1"}]], "+", 
               RowBox[{"I", "*", 
                SubscriptBox["\[Alpha]", 
                 RowBox[{"i", ",", "2"}]]}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
            RowBox[{
             SubscriptBox["\[Sigma]", 
              RowBox[{"1", ",", "1"}]], "+", 
             RowBox[{"I", "*", 
              SubscriptBox["\[Sigma]", 
               RowBox[{"1", ",", "2"}]]}]}]}], "]"}], ",", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[Beta]", 
                RowBox[{"i", ",", "1"}]], "+", 
               RowBox[{"I", "*", 
                SubscriptBox["\[Beta]", 
                 RowBox[{"i", ",", "2"}]]}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
            RowBox[{
             SubscriptBox["\[Sigma]", 
              RowBox[{"2", ",", "1"}]], "+", 
             RowBox[{"I", "*", 
              SubscriptBox["\[Sigma]", 
               RowBox[{"2", ",", "2"}]]}]}]}], "]"}], ",", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[Gamma]", 
                RowBox[{"i", ",", "1"}]], "+", 
               RowBox[{"I", "*", 
                SubscriptBox["\[Gamma]", 
                 RowBox[{"i", ",", "2"}]]}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
            RowBox[{
             SubscriptBox["\[Sigma]", 
              RowBox[{"3", ",", "1"}]], "+", 
             RowBox[{"I", "*", 
              SubscriptBox["\[Sigma]", 
               RowBox[{"3", ",", "2"}]]}]}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"sol", " ", "=", " ", 
        RowBox[{"Solve", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#1", "\[Equal]", "0"}], "&"}], "/@", "s"}], ",", 
          "vars"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ta", "=", 
        RowBox[{"itm", "/.", 
         RowBox[{"sol", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"vars", " ", "=", " ", 
        RowBox[{"Intersection", "[", 
         RowBox[{
          RowBox[{"Variables", "@", "ta"}], ",", "vars"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"subs", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Sort", "@", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"vars", "[", 
                RowBox[{"[", "#", "]"}], "]"}], "\[Rule]", "1"}], ",", 
              RowBox[{
               RowBox[{"Function", "[", 
                RowBox[{"e", ",", 
                 RowBox[{"e", "\[Rule]", "0"}]}], "]"}], "/@", 
               RowBox[{"Complement", "[", 
                RowBox[{"vars", ",", 
                 RowBox[{"{", 
                  RowBox[{"vars", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], "}"}]}], "]"}]}]}], "}"}], 
            "]"}]}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{"Range", "@@", 
           RowBox[{"Dimensions", "@", "vars"}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ta", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"ta", "/.", "#"}], "&"}], "/@", "subs"}]}], ";", 
       "\[IndentingNewLine]", "ta"}]}], "\[IndentingNewLine]", "]"}]}], ";"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "\:041f\:0435\:0447\:0430\:0442\:0430\:0435\:0442", " ", 
    "\:043c\:0430\:0442\:0440\:0438\:0446\:0443", " ", "\:0441", " ", 
    "\:043d\:0443\:043c\:0435\:0440\:0430\:0446\:0438\:0435\:0439", " ", 
    "\:0441\:0442\:0440\:043e\:043a", " ", "\:0438", " ", 
    "\:0441\:0442\:043e\:043b\:0431\:0446\:043e\:0432"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PrintMatrix", "[", "matrix_", "]"}], " ", ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"m", " ", "=", " ", "matrix"}], ",", " ", 
       RowBox[{"dim", "=", 
        RowBox[{"Dimensions", "@", "matrix"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"MatrixForm", "[", 
      RowBox[{"m", ",", " ", 
       RowBox[{"TableHeadings", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Range", "@", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
          RowBox[{"Range", "@", 
           RowBox[{"dim", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "\:041c\:0435\:043d\:044f\:0435\:0442", " ", 
    "\:043c\:0435\:0441\:0442\:0430\:043c\:0438", " ", 
    "\:0441\:0442\:043e\:043b\:0431\:0446\:044b", " ", "\:0432", " ", 
    "\:043c\:0430\:0442\:0440\:0438\:0446\:0435"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SwapRows", "[", 
     RowBox[{"matrix_", ",", "from_List", ",", " ", "to_List"}], "]"}], " ", 
    ":=", " ", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"m", " ", "=", " ", "matrix"}], ",", " ", 
        RowBox[{"f", " ", "=", " ", "from"}], ",", " ", 
        RowBox[{"t", "=", "to"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"m", "[", 
         RowBox[{"[", 
          RowBox[{"Flatten", "@", 
           RowBox[{"{", 
            RowBox[{"f", ",", "t"}], "}"}]}], "]"}], "]"}], " ", "=", " ", 
        RowBox[{"m", "[", 
         RowBox[{"[", 
          RowBox[{"Flatten", "@", 
           RowBox[{"{", 
            RowBox[{"t", ",", "f"}], "}"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "m"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "\:041c\:0435\:043d\:044f\:0435\:0442", " ", 
    "\:043c\:0435\:0441\:0442\:0430\:043c\:0438", " ", 
    "\:0441\:0442\:043e\:043b\:0431\:0446\:044b", " ", "\:0432", " ", 
    "\:043c\:0430\:0442\:0440\:0438\:0446\:0435"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SwapColumns", "[", 
     RowBox[{"matrix_", ",", "from_List", ",", " ", "to_List"}], "]"}], " ", ":=",
     " ", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"m", " ", "=", " ", "matrix"}], ",", " ", 
        RowBox[{"f", " ", "=", " ", "from"}], ",", " ", 
        RowBox[{"t", "=", "to"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"m", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"Flatten", "@", 
            RowBox[{"{", 
             RowBox[{"f", ",", "t"}], "}"}]}]}], "]"}], "]"}], " ", "=", " ", 
        
        RowBox[{"m", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{"Flatten", "@", 
            RowBox[{"{", 
             RowBox[{"t", ",", "f"}], "}"}]}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "m"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "\:041f\:0440\:0438\:0432\:043e\:0434\:0438\:0442", " ", 
     "\:0443\:043a\:0430\:0437\:0430\:043d\:043d\:044b\:0439", " ", 
     "\:0441\:0442\:043e\:043b\:0431\:0435\:0446", " ", 
     "\:043c\:0430\:0442\:0440\:0438\:0446\:044b", " ", "\:043a", " ", 
     "\:043d\:0443\:043b\:0435\:0432\:043e\:0443", " ", 
     "\:0432\:0438\:0434\:0443"}], ",", " ", 
    RowBox[{
    "\:043d\:0430\:0447\:0438\:043d\:0430\:044f", " ", "\:0441\:043e", " ", 
     "\:0441\:0442\:0440\:043e\:043a\:0438", " ", "\:0441", " ", 
     "\:043d\:043e\:043c\:0435\:0440\:043e\:043c", " ", "row"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixReduceRow", "[", 
   RowBox[{"matrix_", ",", " ", "row_"}], "]"}], ":=", "\[IndentingNewLine]", 
  
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"m", " ", "=", "matrix"}], ",", " ", 
      RowBox[{"r", " ", "=", " ", "row"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"m", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"#", " ", "-", " ", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "row", "]"}], "]"}], "*", 
          RowBox[{
           RowBox[{"matrix", "[", 
            RowBox[{"[", "row", "]"}], "]"}], "/", 
           RowBox[{"matrix", "[", 
            RowBox[{"[", 
             RowBox[{"row", ",", "row"}], "]"}], "]"}]}]}]}], "&"}], "/@", 
       RowBox[{"matrix", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"row", "+", "1"}], ";;"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "m"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IntegrateTransforms", "[", "transforms_List", "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"tr", "=", "transforms"}], ",", 
       RowBox[{"affine", "=", 
        RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"affine", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"MatrixExp", "[", 
          RowBox[{"t", "*", "#"}], "]"}], "&"}], "/@", "tr"}]}], ";", 
      "\[IndentingNewLine]", "affine"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CheckPreservation", "[", 
    RowBox[{"surface_", ",", " ", "transform_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s", " ", "=", " ", "surface"}], ",", " ", "t", ",", "ts"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t", "=", 
       RowBox[{"transform", ".", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["x", "1"], "+", 
            RowBox[{"I", "*", 
             SubscriptBox["y", "1"]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["x", "2"], "+", 
            RowBox[{"I", "*", 
             SubscriptBox["y", "2"]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"u", "+", 
            RowBox[{"I", "*", "v"}]}], "}"}], ",", 
          RowBox[{"{", "1", "}"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ts", "=", 
       RowBox[{"Subtract", "@@", 
        RowBox[{"(", 
         RowBox[{"FullSimplify", "@", 
          RowBox[{"TransformSurface", "[", 
           RowBox[{"s", ",", " ", "t"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"NumberQ", "[", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Subtract", "@@", "s"}], ")"}], "/", "ts"}], "]"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.70590017284678*^9, 3.705900355840076*^9}, {
   3.705900396405867*^9, 3.705900416249885*^9}, {3.7059004537234087`*^9, 
   3.7059005387606688`*^9}, {3.705900597035365*^9, 3.705900636164819*^9}, {
   3.705900674711316*^9, 3.7059008634428577`*^9}, {3.705900904820285*^9, 
   3.705901031519087*^9}, {3.7059010854639587`*^9, 3.705901088648877*^9}, {
   3.7059013462542753`*^9, 3.7059014217725487`*^9}, {3.7059014719543858`*^9, 
   3.705901476955103*^9}, {3.705905345636821*^9, 3.7059055024546547`*^9}, {
   3.705905539595518*^9, 3.705905562665886*^9}, {3.7059056313303537`*^9, 
   3.705905639768663*^9}, {3.705905922651966*^9, 3.705905927580963*^9}, {
   3.705906167565692*^9, 3.705906169477687*^9}, {3.70590911052824*^9, 
   3.7059091658443832`*^9}, {3.7059092205116673`*^9, 3.705909267760844*^9}, {
   3.705909753594141*^9, 3.7059097537403393`*^9}, {3.705909783836873*^9, 
   3.705909807590777*^9}, {3.705909911900675*^9, 3.705909919435091*^9}, {
   3.705911948672085*^9, 3.7059120298056307`*^9}, {3.705912636355049*^9, 
   3.705912640884589*^9}, {3.7059127300576878`*^9, 3.705912771910239*^9}, {
   3.705912803585864*^9, 3.7059128441776247`*^9}, {3.705912876309354*^9, 
   3.705912876444512*^9}, {3.7059129694073544`*^9, 3.705913028714013*^9}, {
   3.705913099693433*^9, 3.70591313621321*^9}, {3.705913215148446*^9, 
   3.705913216303328*^9}, {3.705913261948687*^9, 3.705913528210655*^9}, {
   3.7059136206239567`*^9, 3.705913670203529*^9}, {3.705913703148285*^9, 
   3.705913749389367*^9}, 3.705913791938903*^9, {3.7059138349082108`*^9, 
   3.705913843699235*^9}, {3.705913901302718*^9, 3.705913919292755*^9}, {
   3.7059140571028767`*^9, 3.705914120720971*^9}, {3.7059141546655207`*^9, 
   3.7059143462366858`*^9}, {3.7059143813106527`*^9, 
   3.7059145528325167`*^9}, {3.70591471236304*^9, 3.705914759820257*^9}, {
   3.705915212627356*^9, 3.705915222848082*^9}, {3.7059152927887373`*^9, 
   3.705915394879549*^9}, {3.705944544571773*^9, 3.7059445462159157`*^9}, 
   3.705944612486775*^9, {3.705944963981979*^9, 3.70594496795975*^9}, {
   3.705945094822371*^9, 3.705945130515921*^9}, {3.705945189305283*^9, 
   3.705945190903283*^9}, {3.705945253187231*^9, 3.705945260672976*^9}, {
   3.7059454413602953`*^9, 3.705945479720186*^9}, {3.705945583280745*^9, 
   3.705945583496439*^9}, {3.705957522503573*^9, 3.705957565024304*^9}, 
   3.705957630373396*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"S", " ", "=", 
   RowBox[{
    RowBox[{"v", "*", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SubscriptBox["x", "2"]}], ")"}]}], " ", "\[Equal]", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["x", "1"], "2"], "+", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SubscriptBox["x", "2"]}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Mu]", "*", 
         SuperscriptBox[
          SubscriptBox["x", "2"], "2"]}], "+", 
        RowBox[{"\[Lambda]", "*", 
         SubscriptBox["x", "2"], "*", 
         SubscriptBox["y", "2"]}], "+", 
        RowBox[{"\[Nu]", "*", 
         SuperscriptBox[
          SubscriptBox["y", "2"], "2"]}]}], ")"}]}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"system", "=", 
   RowBox[{"GetSystem", "[", "S", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matrix", " ", "=", 
   RowBox[{"Normal", "@", 
    RowBox[{
     RowBox[{"CoefficientArrays", "[", 
      RowBox[{"system", ",", "variables"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\<\:041a\:043e\:043b\:0438\:0447\:0435\:0441\:0442\:0432\:043e \:0443\
\:0440\:0430\:0432\:043d\:0435\:043d\:0438\:0439 \:0432 \:0441\:0438\:0441\
\:0442\:0435\:043c\:0435: \>\"", ",", " ", 
    RowBox[{"Length", "@", "system"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\<\:041c\:0430\:043a\:0441\:0438\:043c\:0430\:043b\:044c\:043d\:044b\
\:0439 \:0440\:0430\:043d\:0433 \:043c\:0430\:0442\:0440\:0438\:0446\:044b: \
\>\"", ",", 
    RowBox[{"MatrixRank", "@", "matrix"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ITs", " ", "=", " ", 
   RowBox[{"GetInfinitesimalTransforms", "[", "system", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\<\:0420\:0430\:0437\:043c\:0435\:0440\:043d\:043e\:0441\:0442\:044c \
\:0433\:0440\:0443\:043f\:043f\:044b: \>\"", ",", " ", 
    RowBox[{"Length", "@", "ITs"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "Print", "@", 
   "\"\<\:0418\:043d\:0444\:0438\:043d\:0438\:0442\:0435\:0437\:0438\:043c\
\:0430\:043b\:044c\:043d\:044b\:0435 \:043f\:0440\:0435\:043e\:0431\:0440\
\:0430\:0437\:043e\:0432\:0430\:043d\:0438\:044f:\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"PrintMatrix", "/@", "ITs"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"groups", "=", 
   RowBox[{"IntegrateTransforms", "@", "ITs"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "@", 
  "\"\<\:041e\:0434\:043d\:043e\:043f\:0430\:0440\:0430\:043c\:0435\:0442\
\:0440\:0438\:0447\:0435\:0441\:043a\:0438\:0435 \:0433\:0440\:0443\:043f\
\:043f\:044b:\>\""}], "\[IndentingNewLine]", 
 RowBox[{"PrintMatrix", "/@", 
  RowBox[{"FullSimplify", "@", "groups"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CheckPreservation", "[", 
    RowBox[{"S", ",", "#"}], "]"}], "&"}], "/@", "groups"}]}], "Input",
 CellChangeTimes->{{3.705900363712751*^9, 3.7059003925088997`*^9}, {
   3.705900426654374*^9, 3.705900448582924*^9}, {3.705909521309825*^9, 
   3.7059096115910683`*^9}, {3.705912851099928*^9, 3.705912857453209*^9}, {
   3.705912905202199*^9, 3.70591296450443*^9}, {3.7059131407516108`*^9, 
   3.705913161271819*^9}, {3.705913205588635*^9, 3.705913210836698*^9}, {
   3.705913474875403*^9, 3.705913481575053*^9}, {3.705913676608369*^9, 
   3.7059136980445423`*^9}, {3.7059142082330008`*^9, 3.705914208815818*^9}, {
   3.705944412619957*^9, 3.705944507542472*^9}, {3.705944551535541*^9, 
   3.705944575573967*^9}, {3.705945701921365*^9, 3.705945715947447*^9}, 
   3.705950754185719*^9, {3.705957473485882*^9, 3.7059575103070583`*^9}, {
   3.7059577145101233`*^9, 3.7059577158839617`*^9}, {3.7059578290372953`*^9, 
   3.705957837720471*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\:041a\:043e\:043b\:0438\:0447\:0435\:0441\:0442\:0432\:043e \
\:0443\:0440\:0430\:0432\:043d\:0435\:043d\:0438\:0439 \:0432 \:0441\:0438\
\:0441\:0442\:0435\:043c\:0435: \"\>", "\[InvisibleSpace]", "74"}],
  SequenceForm[
  "\:041a\:043e\:043b\:0438\:0447\:0435\:0441\:0442\:0432\:043e \:0443\:0440\
\:0430\:0432\:043d\:0435\:043d\:0438\:0439 \:0432 \:0441\:0438\:0441\:0442\
\:0435\:043c\:0435: ", 74],
  Editable->False]], "Print",
 CellChangeTimes->{3.705957612511119*^9, 3.7059576684053307`*^9, 
  3.705957717908063*^9, 3.705959584337359*^9, 3.705960505246429*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\:041c\:0430\:043a\:0441\:0438\:043c\:0430\:043b\:044c\:043d\
\:044b\:0439 \:0440\:0430\:043d\:0433 \:043c\:0430\:0442\:0440\:0438\:0446\
\:044b: \"\>", "\[InvisibleSpace]", "19"}],
  SequenceForm[
  "\:041c\:0430\:043a\:0441\:0438\:043c\:0430\:043b\:044c\:043d\:044b\:0439 \
\:0440\:0430\:043d\:0433 \:043c\:0430\:0442\:0440\:0438\:0446\:044b: ", 19],
  Editable->False]], "Print",
 CellChangeTimes->{3.705957612511119*^9, 3.7059576684053307`*^9, 
  3.705957717908063*^9, 3.705959584337359*^9, 3.705960505256565*^9}]
}, Open  ]],

Cell[BoxData[
 TemplateBox[{
  "Solve","svars",
   "\"Equations may not give solutions for all \\\"solve\\\" variables.\"",2,
   401,88,23654645356734088849,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7059595844101*^9, 3.7059605052703667`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\:0420\:0430\:0437\:043c\:0435\:0440\:043d\:043e\:0441\:0442\
\:044c \:0433\:0440\:0443\:043f\:043f\:044b: \"\>", "\[InvisibleSpace]", "5"}],
  SequenceForm[
  "\:0420\:0430\:0437\:043c\:0435\:0440\:043d\:043e\:0441\:0442\:044c \:0433\
\:0440\:0443\:043f\:043f\:044b: ", 5],
  Editable->False]], "Print",
 CellChangeTimes->{3.705957612511119*^9, 3.7059576684053307`*^9, 
  3.705957717908063*^9, 3.705959584337359*^9, 3.705960505297765*^9}],

Cell[BoxData["\<\"\:0418\:043d\:0444\:0438\:043d\:0438\:0442\:0435\:0437\:0438\
\:043c\:0430\:043b\:044c\:043d\:044b\:0435 \:043f\:0440\:0435\:043e\:0431\
\:0440\:0430\:0437\:043e\:0432\:0430\:043d\:0438\:044f:\"\>"], "Print",
 CellChangeTimes->{3.705957612511119*^9, 3.7059576684053307`*^9, 
  3.705957717908063*^9, 3.705959584337359*^9, 3.705960505305955*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         StyleBox["\[Null]",
          ShowStringCharacters->False], 
         TagBox["1",
          HoldForm], 
         TagBox["2",
          HoldForm], 
         TagBox["3",
          HoldForm], 
         TagBox["4",
          HoldForm]},
        {
         TagBox["1",
          HoldForm], "0", 
         FractionBox["1", "2"], "0", 
         FractionBox["1", "2"]},
        {
         TagBox["2",
          HoldForm], "0", "0", "0", "0"},
        {
         TagBox["3",
          HoldForm], "\[ImaginaryI]", "0", "0", "0"},
        {
         TagBox["4",
          HoldForm], "0", "0", "0", "0"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxDividers->{
        "Columns" -> {False, True, {False}, False}, "ColumnsIndexed" -> {}, 
         "Rows" -> {False, True, {False}, False}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      {OutputFormsDump`HeadedRows, OutputFormsDump`HeadedColumns}], 
     "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> {{1, 2, 3, 4}, {1, 2, 3, 4}}]]], 
   ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         StyleBox["\[Null]",
          ShowStringCharacters->False], 
         TagBox["1",
          HoldForm], 
         TagBox["2",
          HoldForm], 
         TagBox["3",
          HoldForm], 
         TagBox["4",
          HoldForm]},
        {
         TagBox["1",
          HoldForm], 
         FractionBox["3", "4"], "0", "0", "0"},
        {
         TagBox["2",
          HoldForm], "0", 
         FractionBox["1", "2"], "0", 
         FractionBox["1", "2"]},
        {
         TagBox["3",
          HoldForm], "0", 
         RowBox[{
          FractionBox["\[Lambda]", "2"], "+", 
          RowBox[{"\[ImaginaryI]", " ", "\[Mu]"}]}], "1", "0"},
        {
         TagBox["4",
          HoldForm], "0", "0", "0", "0"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxDividers->{
        "Columns" -> {False, True, {False}, False}, "ColumnsIndexed" -> {}, 
         "Rows" -> {False, True, {False}, False}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      {OutputFormsDump`HeadedRows, OutputFormsDump`HeadedColumns}], 
     "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> {{1, 2, 3, 4}, {1, 2, 3, 4}}]]], 
   ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         StyleBox["\[Null]",
          ShowStringCharacters->False], 
         TagBox["1",
          HoldForm], 
         TagBox["2",
          HoldForm], 
         TagBox["3",
          HoldForm], 
         TagBox["4",
          HoldForm]},
        {
         TagBox["1",
          HoldForm], "0", "0", "0", "\[ImaginaryI]"},
        {
         TagBox["2",
          HoldForm], "0", "0", "0", "0"},
        {
         TagBox["3",
          HoldForm], "0", "0", "0", "0"},
        {
         TagBox["4",
          HoldForm], "0", "0", "0", "0"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxDividers->{
        "Columns" -> {False, True, {False}, False}, "ColumnsIndexed" -> {}, 
         "Rows" -> {False, True, {False}, False}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      {OutputFormsDump`HeadedRows, OutputFormsDump`HeadedColumns}], 
     "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> {{1, 2, 3, 4}, {1, 2, 3, 4}}]]], 
   ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         StyleBox["\[Null]",
          ShowStringCharacters->False], 
         TagBox["1",
          HoldForm], 
         TagBox["2",
          HoldForm], 
         TagBox["3",
          HoldForm], 
         TagBox["4",
          HoldForm]},
        {
         TagBox["1",
          HoldForm], "0", "0", "0", "0"},
        {
         TagBox["2",
          HoldForm], "0", "0", "0", "\[ImaginaryI]"},
        {
         TagBox["3",
          HoldForm], "0", 
         RowBox[{
          RowBox[{"\[ImaginaryI]", " ", "\[Lambda]"}], "+", 
          RowBox[{"2", " ", "\[Nu]"}]}], "0", "0"},
        {
         TagBox["4",
          HoldForm], "0", "0", "0", "0"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxDividers->{
        "Columns" -> {False, True, {False}, False}, "ColumnsIndexed" -> {}, 
         "Rows" -> {False, True, {False}, False}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      {OutputFormsDump`HeadedRows, OutputFormsDump`HeadedColumns}], 
     "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> {{1, 2, 3, 4}, {1, 2, 3, 4}}]]], 
   ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         StyleBox["\[Null]",
          ShowStringCharacters->False], 
         TagBox["1",
          HoldForm], 
         TagBox["2",
          HoldForm], 
         TagBox["3",
          HoldForm], 
         TagBox["4",
          HoldForm]},
        {
         TagBox["1",
          HoldForm], "0", "0", "0", "0"},
        {
         TagBox["2",
          HoldForm], "0", "0", "0", "0"},
        {
         TagBox["3",
          HoldForm], "0", "0", "0", "1"},
        {
         TagBox["4",
          HoldForm], "0", "0", "0", "0"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxDividers->{
        "Columns" -> {False, True, {False}, False}, "ColumnsIndexed" -> {}, 
         "Rows" -> {False, True, {False}, False}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      {OutputFormsDump`HeadedRows, OutputFormsDump`HeadedColumns}], 
     "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     BoxForm`e$, TableHeadings -> {{1, 2, 3, 4}, {1, 2, 3, 4}}]]]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.705945555850319*^9, 3.7059456437488422`*^9, {3.7059457040912447`*^9, 
   3.70594573465165*^9}, 3.7059507564433126`*^9, {3.705957483200767*^9, 
   3.705957511752399*^9}, 3.7059575448846207`*^9, {3.705957597673911*^9, 
   3.7059576124593077`*^9}, 3.7059576683849583`*^9, 3.7059577178894863`*^9, 
   3.705959584445209*^9, 3.705960505319859*^9}],

Cell[BoxData["\<\"\:041e\:0434\:043d\:043e\:043f\:0430\:0440\:0430\:043c\:0435\
\:0442\:0440\:0438\:0447\:0435\:0441\:043a\:0438\:0435 \:0433\:0440\:0443\
\:043f\:043f\:044b:\"\>"], "Print",
 CellChangeTimes->{3.705957612511119*^9, 3.7059576684053307`*^9, 
  3.705957717908063*^9, 3.705959584337359*^9, 3.7059605053290253`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         StyleBox["\[Null]",
          ShowStringCharacters->False], 
         TagBox["1",
          HoldForm], 
         TagBox["2",
          HoldForm], 
         TagBox["3",
          HoldForm], 
         TagBox["4",
          HoldForm]},
        {
         TagBox["1",
          HoldForm], "1", 
         FractionBox["t", "2"], "0", 
         FractionBox["t", "2"]},
        {
         TagBox["2",
          HoldForm], "0", "1", "0", "0"},
        {
         TagBox["3",
          HoldForm], 
         RowBox[{"\[ImaginaryI]", " ", "t"}], 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", 
           SuperscriptBox["t", "2"]}], "4"], "1", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", 
           SuperscriptBox["t", "2"]}], "4"]},
        {
         TagBox["4",
          HoldForm], "0", "0", "0", "1"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxDividers->{
        "Columns" -> {False, True, {False}, False}, "ColumnsIndexed" -> {}, 
         "Rows" -> {False, True, {False}, False}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      {OutputFormsDump`HeadedRows, OutputFormsDump`HeadedColumns}], 
     "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> {{1, 2, 3, 4}, {1, 2, 3, 4}}]]], 
   ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         StyleBox["\[Null]",
          ShowStringCharacters->False], 
         TagBox["1",
          HoldForm], 
         TagBox["2",
          HoldForm], 
         TagBox["3",
          HoldForm], 
         TagBox["4",
          HoldForm]},
        {
         TagBox["1",
          HoldForm], 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"3", " ", "t"}], "/", "4"}]], "0", "0", "0"},
        {
         TagBox["2",
          HoldForm], "0", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"t", "/", "2"}]], "0", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"t", "/", "2"}]]}]},
        {
         TagBox["3",
          HoldForm], "0", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"t", "/", "2"}]]}], "+", 
            SuperscriptBox["\[ExponentialE]", "t"]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]", "+", 
            RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Mu]"}]}], ")"}]}], 
         SuperscriptBox["\[ExponentialE]", "t"], 
         RowBox[{
          FractionBox["1", "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"t", "/", "2"}]]}], ")"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]", "+", 
            RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Mu]"}]}], ")"}]}]},
        {
         TagBox["4",
          HoldForm], "0", "0", "0", "1"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxDividers->{
        "Columns" -> {False, True, {False}, False}, "ColumnsIndexed" -> {}, 
         "Rows" -> {False, True, {False}, False}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      {OutputFormsDump`HeadedRows, OutputFormsDump`HeadedColumns}], 
     "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> {{1, 2, 3, 4}, {1, 2, 3, 4}}]]], 
   ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         StyleBox["\[Null]",
          ShowStringCharacters->False], 
         TagBox["1",
          HoldForm], 
         TagBox["2",
          HoldForm], 
         TagBox["3",
          HoldForm], 
         TagBox["4",
          HoldForm]},
        {
         TagBox["1",
          HoldForm], "1", "0", "0", 
         RowBox[{"\[ImaginaryI]", " ", "t"}]},
        {
         TagBox["2",
          HoldForm], "0", "1", "0", "0"},
        {
         TagBox["3",
          HoldForm], "0", "0", "1", "0"},
        {
         TagBox["4",
          HoldForm], "0", "0", "0", "1"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxDividers->{
        "Columns" -> {False, True, {False}, False}, "ColumnsIndexed" -> {}, 
         "Rows" -> {False, True, {False}, False}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      {OutputFormsDump`HeadedRows, OutputFormsDump`HeadedColumns}], 
     "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> {{1, 2, 3, 4}, {1, 2, 3, 4}}]]], 
   ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         StyleBox["\[Null]",
          ShowStringCharacters->False], 
         TagBox["1",
          HoldForm], 
         TagBox["2",
          HoldForm], 
         TagBox["3",
          HoldForm], 
         TagBox["4",
          HoldForm]},
        {
         TagBox["1",
          HoldForm], "1", "0", "0", "0"},
        {
         TagBox["2",
          HoldForm], "0", "1", "0", 
         RowBox[{"\[ImaginaryI]", " ", "t"}]},
        {
         TagBox["3",
          HoldForm], "0", 
         RowBox[{"t", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[ImaginaryI]", " ", "\[Lambda]"}], "+", 
            RowBox[{"2", " ", "\[Nu]"}]}], ")"}]}], "1", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["1", "2"]}], " ", 
          SuperscriptBox["t", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]", "-", 
            RowBox[{"2", " ", "\[ImaginaryI]", " ", "\[Nu]"}]}], ")"}]}]},
        {
         TagBox["4",
          HoldForm], "0", "0", "0", "1"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxDividers->{
        "Columns" -> {False, True, {False}, False}, "ColumnsIndexed" -> {}, 
         "Rows" -> {False, True, {False}, False}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      {OutputFormsDump`HeadedRows, OutputFormsDump`HeadedColumns}], 
     "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$, TableHeadings -> {{1, 2, 3, 4}, {1, 2, 3, 4}}]]], 
   ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {
         StyleBox["\[Null]",
          ShowStringCharacters->False], 
         TagBox["1",
          HoldForm], 
         TagBox["2",
          HoldForm], 
         TagBox["3",
          HoldForm], 
         TagBox["4",
          HoldForm]},
        {
         TagBox["1",
          HoldForm], "1", "0", "0", "0"},
        {
         TagBox["2",
          HoldForm], "0", "1", "0", "0"},
        {
         TagBox["3",
          HoldForm], "0", "0", "1", "t"},
        {
         TagBox["4",
          HoldForm], "0", "0", "0", "1"}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxDividers->{
        "Columns" -> {False, True, {False}, False}, "ColumnsIndexed" -> {}, 
         "Rows" -> {False, True, {False}, False}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.7]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      {OutputFormsDump`HeadedRows, OutputFormsDump`HeadedColumns}], 
     "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     BoxForm`e$, TableHeadings -> {{1, 2, 3, 4}, {1, 2, 3, 4}}]]]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.705945555850319*^9, 3.7059456437488422`*^9, {3.7059457040912447`*^9, 
   3.70594573465165*^9}, 3.7059507564433126`*^9, {3.705957483200767*^9, 
   3.705957511752399*^9}, 3.7059575448846207`*^9, {3.705957597673911*^9, 
   3.7059576124593077`*^9}, 3.7059576683849583`*^9, 3.7059577178894863`*^9, 
   3.705959584445209*^9, 3.7059605053373013`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"True", ",", "True", ",", "True", ",", "True", ",", "True"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.705945555850319*^9, 3.7059456437488422`*^9, {3.7059457040912447`*^9, 
   3.70594573465165*^9}, 3.7059507564433126`*^9, {3.705957483200767*^9, 
   3.705957511752399*^9}, 3.7059575448846207`*^9, {3.705957597673911*^9, 
   3.7059576124593077`*^9}, 3.7059576683849583`*^9, 3.7059577178894863`*^9, 
   3.705959584445209*^9, 3.705960505725163*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Column", "@", "system"}]], "Input",
 CellChangeTimes->{{3.705944654806643*^9, 3.705944656281012*^9}, {
  3.7059448211897697`*^9, 3.7059448251663227`*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"-", 
      SubscriptBox["\[Beta]", 
       RowBox[{"1", ",", "2"}]]}]},
    {
     RowBox[{
      SubscriptBox["\[Beta]", 
       RowBox[{"1", ",", "1"}]], "-", 
      SubscriptBox["\[Beta]", 
       RowBox[{"3", ",", "1"}]]}]},
    {
     RowBox[{"-", 
      SubscriptBox["\[Beta]", 
       RowBox[{"3", ",", "2"}]]}]},
    {
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "\[Mu]", " ", 
       SubscriptBox["\[Beta]", 
        RowBox[{"1", ",", "1"}]]}], "-", 
      RowBox[{"\[Mu]", " ", 
       SubscriptBox["\[Beta]", 
        RowBox[{"3", ",", "1"}]]}]}]},
    {
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "\[Nu]", " ", 
       SubscriptBox["\[Beta]", 
        RowBox[{"1", ",", "2"}]]}], "+", 
      RowBox[{"\[Mu]", " ", 
       SubscriptBox["\[Beta]", 
        RowBox[{"3", ",", "2"}]]}]}]},
    {
     RowBox[{
      RowBox[{"-", 
       SubscriptBox["\[Beta]", 
        RowBox[{"2", ",", "2"}]]}], "+", 
      SubscriptBox["\[Gamma]", 
       RowBox[{"1", ",", "2"}]]}]},
    {
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       SubscriptBox["k", "3"], " ", 
       SubscriptBox["\[Alpha]", 
        RowBox[{"1", ",", "2"}]]}], "-", 
      SubscriptBox["\[Beta]", 
       RowBox[{"1", ",", "1"}]]}]},
    {
     RowBox[{
      RowBox[{"-", "3"}], " ", "\[Nu]", " ", 
      SubscriptBox["\[Beta]", 
       RowBox[{"3", ",", "1"}]]}]},
    {
     RowBox[{
      RowBox[{"-", 
       SubscriptBox["\[Alpha]", 
        RowBox[{"1", ",", "1"}]]}], "+", 
      SubscriptBox["\[Gamma]", 
       RowBox[{"3", ",", "1"}]]}]},
    {
     RowBox[{"-", 
      SubscriptBox["\[Beta]", 
       RowBox[{"3", ",", "2"}]]}]},
    {
     RowBox[{"-", 
      SubscriptBox["\[Sigma]", 
       RowBox[{"2", ",", "2"}]]}]},
    {
     RowBox[{
      RowBox[{
       SubscriptBox["k", "3"], " ", 
       SubscriptBox["\[Beta]", 
        RowBox[{"1", ",", "1"}]]}], "-", 
      RowBox[{
       SubscriptBox["k", "3"], " ", 
       SubscriptBox["\[Beta]", 
        RowBox[{"3", ",", "1"}]]}]}]},
    {
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       SubscriptBox["k", "3"], " ", 
       SubscriptBox["\[Alpha]", 
        RowBox[{"3", ",", "1"}]]}], "-", 
      SubscriptBox["\[Beta]", 
       RowBox[{"1", ",", "2"}]]}]},
    {
     RowBox[{
      RowBox[{"-", "\[Nu]"}], " ", 
      SubscriptBox["\[Beta]", 
       RowBox[{"3", ",", "2"}]]}]},
    {
     RowBox[{
      SubscriptBox["\[Alpha]", 
       RowBox[{"3", ",", "2"}]], "-", 
      SubscriptBox["\[Beta]", 
       RowBox[{"2", ",", "2"}]]}]},
    {
     SubscriptBox["\[Beta]", 
      RowBox[{"3", ",", "1"}]]},
    {
     SubscriptBox["\[Sigma]", 
      RowBox[{"2", ",", "1"}]]},
    {
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      SubscriptBox["k", "3"], " ", 
      SubscriptBox["\[Beta]", 
       RowBox[{"3", ",", "2"}]]}]},
    {
     RowBox[{"2", " ", 
      SuperscriptBox["\[Mu]", "2"], " ", 
      SubscriptBox["\[Beta]", 
       RowBox[{"3", ",", "2"}]]}]},
    {
     RowBox[{
      RowBox[{"-", "2"}], " ", "\[Mu]", " ", "\[Nu]", " ", 
      SubscriptBox["\[Beta]", 
       RowBox[{"3", ",", "1"}]]}]},
    {
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "\[Mu]", " ", 
       SubscriptBox["\[Beta]", 
        RowBox[{"2", ",", "1"}]]}], "+", 
      RowBox[{"\[Mu]", " ", 
       SubscriptBox["\[Gamma]", 
        RowBox[{"3", ",", "1"}]]}]}]},
    {
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "\[Mu]", " ", 
       SubscriptBox["k", "3"], " ", 
       SubscriptBox["\[Alpha]", 
        RowBox[{"3", ",", "1"}]]}], "+", 
      RowBox[{"2", " ", "\[Mu]", " ", 
       SubscriptBox["\[Beta]", 
        RowBox[{"1", ",", "2"}]]}]}]},
    {
     RowBox[{"2", " ", "\[Mu]", " ", "\[Nu]", " ", 
      SubscriptBox["\[Beta]", 
       RowBox[{"3", ",", "2"}]]}]},
    {
     RowBox[{
      RowBox[{"\[Mu]", " ", 
       SubscriptBox["\[Alpha]", 
        RowBox[{"3", ",", "2"}]]}], "+", 
      RowBox[{"2", " ", "\[Mu]", " ", 
       SubscriptBox["\[Beta]", 
        RowBox[{"2", ",", "2"}]]}], "-", 
      RowBox[{"2", " ", "\[Nu]", " ", 
       SubscriptBox["\[Beta]", 
        RowBox[{"2", ",", "2"}]]}]}]},
    {
     RowBox[{
      RowBox[{"-", "2"}], " ", "\[Mu]", " ", 
      SubscriptBox["\[Beta]", 
       RowBox[{"3", ",", "1"}]]}]},
    {
     RowBox[{
      SubscriptBox["\[Gamma]", 
       RowBox[{"2", ",", "2"}]], "-", 
      RowBox[{"2", " ", "\[Mu]", " ", 
       SubscriptBox["\[Sigma]", 
        RowBox[{"2", ",", "1"}]]}]}]},
    {
     RowBox[{"\[Mu]", " ", 
      SubscriptBox["k", "3"], " ", 
      SubscriptBox["\[Beta]", 
       RowBox[{"3", ",", "2"}]]}]},
    {
     RowBox[{
      RowBox[{"-", "2"}], " ", "\[Nu]", " ", 
      SubscriptBox["\[Beta]", 
       RowBox[{"1", ",", "1"}]]}]},
    {
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       SubscriptBox["k", "3"], " ", 
       SubscriptBox["\[Alpha]", 
        RowBox[{"2", ",", "2"}]]}], "+", 
      SubscriptBox["\[Gamma]", 
       RowBox[{"1", ",", "1"}]]}]},
    {
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      SuperscriptBox["\[Nu]", "2"], " ", 
      SubscriptBox["\[Beta]", 
       RowBox[{"3", ",", "1"}]]}]},
    {
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "\[Nu]", " ", 
       SubscriptBox["\[Beta]", 
        RowBox[{"2", ",", "1"}]]}], "+", 
      RowBox[{"\[Nu]", " ", 
       SubscriptBox["\[Gamma]", 
        RowBox[{"3", ",", "1"}]]}]}]},
    {
     RowBox[{
      RowBox[{"-", "2"}], " ", "\[Nu]", " ", 
      SubscriptBox["\[Beta]", 
       RowBox[{"3", ",", "2"}]]}]},
    {
     RowBox[{
      RowBox[{"-", 
       SubscriptBox["\[Alpha]", 
        RowBox[{"2", ",", "1"}]]}], "+", 
      SubscriptBox["\[Gamma]", 
       RowBox[{"2", ",", "1"}]], "-", 
      RowBox[{"2", " ", "\[Nu]", " ", 
       SubscriptBox["\[Sigma]", 
        RowBox[{"2", ",", "2"}]]}]}]},
    {
     SubscriptBox["\[Gamma]", 
      RowBox[{"3", ",", "2"}]]},
    {
     SubscriptBox["\[Sigma]", 
      RowBox[{"3", ",", "2"}]]},
    {
     RowBox[{
      RowBox[{"-", "2"}], " ", "\[Nu]", " ", 
      SubscriptBox["k", "3"], " ", 
      SubscriptBox["\[Beta]", 
       RowBox[{"3", ",", "1"}]]}]},
    {
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       SubscriptBox["k", "3"], " ", 
       SubscriptBox["\[Alpha]", 
        RowBox[{"1", ",", "1"}]]}], "+", 
      RowBox[{
       SubscriptBox["k", "3"], " ", 
       SubscriptBox["\[Beta]", 
        RowBox[{"2", ",", "1"}]]}], "+", 
      RowBox[{
       SubscriptBox["k", "3"], " ", 
       SubscriptBox["\[Gamma]", 
        RowBox[{"3", ",", "1"}]]}]}]},
    {
     RowBox[{
      RowBox[{"-", "2"}], " ", "\[Nu]", " ", 
      SubscriptBox["k", "3"], " ", 
      SubscriptBox["\[Alpha]", 
       RowBox[{"3", ",", "1"}]]}]},
    {
     RowBox[{
      SubscriptBox["\[Alpha]", 
       RowBox[{"1", ",", "2"}]], "-", 
      RowBox[{"2", " ", 
       SubscriptBox["k", "3"], " ", 
       SubscriptBox["\[Alpha]", 
        RowBox[{"2", ",", "1"}]]}]}]},
    {
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      SubscriptBox["k", "3"], " ", 
      SubscriptBox["\[Alpha]", 
       RowBox[{"3", ",", "2"}]]}]},
    {
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      SubscriptBox["k", "3"], " ", 
      SubscriptBox["\[Sigma]", 
       RowBox[{"1", ",", "2"}]]}]},
    {
     RowBox[{"\[Nu]", " ", 
      SubscriptBox["\[Alpha]", 
       RowBox[{"3", ",", "2"}]]}]},
    {
     SubscriptBox["\[Alpha]", 
      RowBox[{"2", ",", "2"}]]},
    {
     RowBox[{"-", 
      SubscriptBox["\[Alpha]", 
       RowBox[{"3", ",", "1"}]]}]},
    {
     RowBox[{"-", 
      SubscriptBox["\[Sigma]", 
       RowBox[{"1", ",", "1"}]]}]},
    {
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       SubsuperscriptBox["k", "3", "2"], " ", 
       SubscriptBox["\[Alpha]", 
        RowBox[{"3", ",", "1"}]]}], "-", 
      RowBox[{
       SubscriptBox["k", "3"], " ", 
       SubscriptBox["\[Beta]", 
        RowBox[{"1", ",", "2"}]]}]}]},
    {
     RowBox[{
      RowBox[{"-", "\[Nu]"}], " ", 
      SubscriptBox["k", "3"], " ", 
      SubscriptBox["\[Beta]", 
       RowBox[{"3", ",", "2"}]]}]},
    {
     RowBox[{
      RowBox[{
       SubscriptBox["k", "3"], " ", 
       SubscriptBox["\[Alpha]", 
        RowBox[{"3", ",", "2"}]]}], "-", 
      RowBox[{
       SubscriptBox["k", "3"], " ", 
       SubscriptBox["\[Beta]", 
        RowBox[{"2", ",", "2"}]]}]}]},
    {
     RowBox[{
      SubscriptBox["k", "3"], " ", 
      SubscriptBox["\[Beta]", 
       RowBox[{"3", ",", "1"}]]}]},
    {
     RowBox[{
      SubscriptBox["k", "3"], " ", 
      SubscriptBox["\[Sigma]", 
       RowBox[{"2", ",", "1"}]]}]},
    {
     RowBox[{
      RowBox[{"-", 
       SubsuperscriptBox["k", "3", "2"]}], " ", 
      SubscriptBox["\[Beta]", 
       RowBox[{"3", ",", "2"}]]}]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{3.705944825467157*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"m", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      SubscriptBox["k", "2"]}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["x", "1"], " ", 
        SubscriptBox["a", 
         RowBox[{"1", ",", "1"}]]}], "-", 
       RowBox[{
        SubscriptBox["y", "1"], " ", 
        SubscriptBox["a", 
         RowBox[{"1", ",", "2"}]]}], "+", 
       RowBox[{
        SubscriptBox["x", "2"], " ", 
        SubscriptBox["a", 
         RowBox[{"2", ",", "1"}]]}], "-", 
       RowBox[{
        SubscriptBox["y", "2"], " ", 
        SubscriptBox["a", 
         RowBox[{"2", ",", "2"}]]}], "+", 
       RowBox[{"u", " ", 
        SubscriptBox["a", 
         RowBox[{"3", ",", "1"}]]}], "-", 
       RowBox[{"v", " ", 
        SubscriptBox["a", 
         RowBox[{"3", ",", "2"}]]}], "+", 
       SubscriptBox["p", 
        RowBox[{"1", ",", "1"}]]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["y", "1"], " ", 
        SubscriptBox["a", 
         RowBox[{"1", ",", "1"}]]}], "+", 
       RowBox[{
        SubscriptBox["x", "1"], " ", 
        SubscriptBox["a", 
         RowBox[{"1", ",", "2"}]]}], "+", 
       RowBox[{
        SubscriptBox["y", "2"], " ", 
        SubscriptBox["a", 
         RowBox[{"2", ",", "1"}]]}], "+", 
       RowBox[{
        SubscriptBox["x", "2"], " ", 
        SubscriptBox["a", 
         RowBox[{"2", ",", "2"}]]}], "+", 
       RowBox[{"v", " ", 
        SubscriptBox["a", 
         RowBox[{"3", ",", "1"}]]}], "+", 
       RowBox[{"u", " ", 
        SubscriptBox["a", 
         RowBox[{"3", ",", "2"}]]}], "+", 
       SubscriptBox["p", 
        RowBox[{"1", ",", "2"}]]}], ")"}]}], "-", 
    RowBox[{
     SubscriptBox["k", "3"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["y", "1"], " ", 
         SubscriptBox["a", 
          RowBox[{"1", ",", "1"}]]}], "+", 
        RowBox[{
         SubscriptBox["x", "1"], " ", 
         SubscriptBox["a", 
          RowBox[{"1", ",", "2"}]]}], "+", 
        RowBox[{
         SubscriptBox["y", "2"], " ", 
         SubscriptBox["a", 
          RowBox[{"2", ",", "1"}]]}], "+", 
        RowBox[{
         SubscriptBox["x", "2"], " ", 
         SubscriptBox["a", 
          RowBox[{"2", ",", "2"}]]}], "+", 
        RowBox[{"v", " ", 
         SubscriptBox["a", 
          RowBox[{"3", ",", "1"}]]}], "+", 
        RowBox[{"u", " ", 
         SubscriptBox["a", 
          RowBox[{"3", ",", "2"}]]}], "+", 
        SubscriptBox["p", 
         RowBox[{"1", ",", "2"}]]}], ")"}], "2"]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["q", "2"], "+", 
       RowBox[{
        SubscriptBox["y", "1"], " ", 
        SubscriptBox["c", 
         RowBox[{"1", ",", "1"}]]}], "+", 
       RowBox[{
        SubscriptBox["x", "1"], " ", 
        SubscriptBox["c", 
         RowBox[{"1", ",", "2"}]]}], "+", 
       RowBox[{
        SubscriptBox["y", "2"], " ", 
        SubscriptBox["c", 
         RowBox[{"2", ",", "1"}]]}], "+", 
       RowBox[{
        SubscriptBox["x", "2"], " ", 
        SubscriptBox["c", 
         RowBox[{"2", ",", "2"}]]}], "+", 
       RowBox[{"v", " ", 
        SubscriptBox["c", 
         RowBox[{"3", ",", "1"}]]}], "+", 
       RowBox[{"u", " ", 
        SubscriptBox["c", 
         RowBox[{"3", ",", "2"}]]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["x", "1"], " ", 
        SubscriptBox["b", 
         RowBox[{"1", ",", "1"}]]}], "-", 
       RowBox[{
        SubscriptBox["y", "1"], " ", 
        SubscriptBox["b", 
         RowBox[{"1", ",", "2"}]]}], "+", 
       RowBox[{
        SubscriptBox["x", "2"], " ", 
        SubscriptBox["b", 
         RowBox[{"2", ",", "1"}]]}], "-", 
       RowBox[{
        SubscriptBox["y", "2"], " ", 
        SubscriptBox["b", 
         RowBox[{"2", ",", "2"}]]}], "+", 
       RowBox[{"u", " ", 
        SubscriptBox["b", 
         RowBox[{"3", ",", "1"}]]}], "-", 
       RowBox[{"v", " ", 
        SubscriptBox["b", 
         RowBox[{"3", ",", "2"}]]}], "+", 
       SubscriptBox["p", 
        RowBox[{"2", ",", "1"}]]}], ")"}]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["x", "1"], " ", 
        SubscriptBox["b", 
         RowBox[{"1", ",", "1"}]]}], "-", 
       RowBox[{
        SubscriptBox["y", "1"], " ", 
        SubscriptBox["b", 
         RowBox[{"1", ",", "2"}]]}], "+", 
       RowBox[{
        SubscriptBox["x", "2"], " ", 
        SubscriptBox["b", 
         RowBox[{"2", ",", "1"}]]}], "-", 
       RowBox[{
        SubscriptBox["y", "2"], " ", 
        SubscriptBox["b", 
         RowBox[{"2", ",", "2"}]]}], "+", 
       RowBox[{"u", " ", 
        SubscriptBox["b", 
         RowBox[{"3", ",", "1"}]]}], "-", 
       RowBox[{"v", " ", 
        SubscriptBox["b", 
         RowBox[{"3", ",", "2"}]]}], "+", 
       SubscriptBox["p", 
        RowBox[{"2", ",", "1"}]]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Mu]", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["x", "1"], " ", 
            SubscriptBox["b", 
             RowBox[{"1", ",", "1"}]]}], "-", 
           RowBox[{
            SubscriptBox["y", "1"], " ", 
            SubscriptBox["b", 
             RowBox[{"1", ",", "2"}]]}], "+", 
           RowBox[{
            SubscriptBox["x", "2"], " ", 
            SubscriptBox["b", 
             RowBox[{"2", ",", "1"}]]}], "-", 
           RowBox[{
            SubscriptBox["y", "2"], " ", 
            SubscriptBox["b", 
             RowBox[{"2", ",", "2"}]]}], "+", 
           RowBox[{"u", " ", 
            SubscriptBox["b", 
             RowBox[{"3", ",", "1"}]]}], "-", 
           RowBox[{"v", " ", 
            SubscriptBox["b", 
             RowBox[{"3", ",", "2"}]]}], "+", 
           SubscriptBox["p", 
            RowBox[{"2", ",", "1"}]]}], ")"}], "2"]}], "+", 
       RowBox[{"\[Nu]", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["y", "1"], " ", 
            SubscriptBox["b", 
             RowBox[{"1", ",", "1"}]]}], "+", 
           RowBox[{
            SubscriptBox["x", "1"], " ", 
            SubscriptBox["b", 
             RowBox[{"1", ",", "2"}]]}], "+", 
           RowBox[{
            SubscriptBox["y", "2"], " ", 
            SubscriptBox["b", 
             RowBox[{"2", ",", "1"}]]}], "+", 
           RowBox[{
            SubscriptBox["x", "2"], " ", 
            SubscriptBox["b", 
             RowBox[{"2", ",", "2"}]]}], "+", 
           RowBox[{"v", " ", 
            SubscriptBox["b", 
             RowBox[{"3", ",", "1"}]]}], "+", 
           RowBox[{"u", " ", 
            SubscriptBox["b", 
             RowBox[{"3", ",", "2"}]]}], "+", 
           SubscriptBox["p", 
            RowBox[{"2", ",", "2"}]]}], ")"}], "2"]}]}], ")"}]}]}], "/.", 
   "parameterSubstitutions"}]}]], "Input",
 CellChangeTimes->{{3.7059457537299833`*^9, 3.705945761555971*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    SubscriptBox["k", "2"]}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox["x", "1"], " ", 
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"1", ",", "1"}]], "[", "t", "]"}]}], "-", 
     RowBox[{
      SubscriptBox["y", "1"], " ", 
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"1", ",", "2"}]], "[", "t", "]"}]}], "+", 
     RowBox[{
      SubscriptBox["x", "2"], " ", 
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"2", ",", "1"}]], "[", "t", "]"}]}], "-", 
     RowBox[{
      SubscriptBox["y", "2"], " ", 
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"2", ",", "2"}]], "[", "t", "]"}]}], "+", 
     RowBox[{"u", " ", 
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"3", ",", "1"}]], "[", "t", "]"}]}], "-", 
     RowBox[{"v", " ", 
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"3", ",", "2"}]], "[", "t", "]"}]}], "+", 
     RowBox[{
      SubscriptBox["p", 
       RowBox[{"1", ",", "1"}]], "[", "t", "]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox["y", "1"], " ", 
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"1", ",", "1"}]], "[", "t", "]"}]}], "+", 
     RowBox[{
      SubscriptBox["x", "1"], " ", 
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"1", ",", "2"}]], "[", "t", "]"}]}], "+", 
     RowBox[{
      SubscriptBox["y", "2"], " ", 
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"2", ",", "1"}]], "[", "t", "]"}]}], "+", 
     RowBox[{
      SubscriptBox["x", "2"], " ", 
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"2", ",", "2"}]], "[", "t", "]"}]}], "+", 
     RowBox[{"v", " ", 
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"3", ",", "1"}]], "[", "t", "]"}]}], "+", 
     RowBox[{"u", " ", 
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"3", ",", "2"}]], "[", "t", "]"}]}], "+", 
     RowBox[{
      SubscriptBox["p", 
       RowBox[{"1", ",", "2"}]], "[", "t", "]"}]}], ")"}]}], "-", 
  RowBox[{
   SubscriptBox["k", "3"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["y", "1"], " ", 
       RowBox[{
        SubscriptBox["a", 
         RowBox[{"1", ",", "1"}]], "[", "t", "]"}]}], "+", 
      RowBox[{
       SubscriptBox["x", "1"], " ", 
       RowBox[{
        SubscriptBox["a", 
         RowBox[{"1", ",", "2"}]], "[", "t", "]"}]}], "+", 
      RowBox[{
       SubscriptBox["y", "2"], " ", 
       RowBox[{
        SubscriptBox["a", 
         RowBox[{"2", ",", "1"}]], "[", "t", "]"}]}], "+", 
      RowBox[{
       SubscriptBox["x", "2"], " ", 
       RowBox[{
        SubscriptBox["a", 
         RowBox[{"2", ",", "2"}]], "[", "t", "]"}]}], "+", 
      RowBox[{"v", " ", 
       RowBox[{
        SubscriptBox["a", 
         RowBox[{"3", ",", "1"}]], "[", "t", "]"}]}], "+", 
      RowBox[{"u", " ", 
       RowBox[{
        SubscriptBox["a", 
         RowBox[{"3", ",", "2"}]], "[", "t", "]"}]}], "+", 
      RowBox[{
       SubscriptBox["p", 
        RowBox[{"1", ",", "2"}]], "[", "t", "]"}]}], ")"}], "2"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "2"], "[", "t", "]"}], "+", 
     RowBox[{
      SubscriptBox["y", "1"], " ", 
      RowBox[{
       SubscriptBox["c", 
        RowBox[{"1", ",", "1"}]], "[", "t", "]"}]}], "+", 
     RowBox[{
      SubscriptBox["x", "1"], " ", 
      RowBox[{
       SubscriptBox["c", 
        RowBox[{"1", ",", "2"}]], "[", "t", "]"}]}], "+", 
     RowBox[{
      SubscriptBox["y", "2"], " ", 
      RowBox[{
       SubscriptBox["c", 
        RowBox[{"2", ",", "1"}]], "[", "t", "]"}]}], "+", 
     RowBox[{
      SubscriptBox["x", "2"], " ", 
      RowBox[{
       SubscriptBox["c", 
        RowBox[{"2", ",", "2"}]], "[", "t", "]"}]}], "+", 
     RowBox[{"v", " ", 
      RowBox[{
       SubscriptBox["c", 
        RowBox[{"3", ",", "1"}]], "[", "t", "]"}]}], "+", 
     RowBox[{"u", " ", 
      RowBox[{
       SubscriptBox["c", 
        RowBox[{"3", ",", "2"}]], "[", "t", "]"}]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox["x", "1"], " ", 
      RowBox[{
       SubscriptBox["b", 
        RowBox[{"1", ",", "1"}]], "[", "t", "]"}]}], "-", 
     RowBox[{
      SubscriptBox["y", "1"], " ", 
      RowBox[{
       SubscriptBox["b", 
        RowBox[{"1", ",", "2"}]], "[", "t", "]"}]}], "+", 
     RowBox[{
      SubscriptBox["x", "2"], " ", 
      RowBox[{
       SubscriptBox["b", 
        RowBox[{"2", ",", "1"}]], "[", "t", "]"}]}], "-", 
     RowBox[{
      SubscriptBox["y", "2"], " ", 
      RowBox[{
       SubscriptBox["b", 
        RowBox[{"2", ",", "2"}]], "[", "t", "]"}]}], "+", 
     RowBox[{"u", " ", 
      RowBox[{
       SubscriptBox["b", 
        RowBox[{"3", ",", "1"}]], "[", "t", "]"}]}], "-", 
     RowBox[{"v", " ", 
      RowBox[{
       SubscriptBox["b", 
        RowBox[{"3", ",", "2"}]], "[", "t", "]"}]}], "+", 
     RowBox[{
      SubscriptBox["p", 
       RowBox[{"2", ",", "1"}]], "[", "t", "]"}]}], ")"}]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox["x", "1"], " ", 
      RowBox[{
       SubscriptBox["b", 
        RowBox[{"1", ",", "1"}]], "[", "t", "]"}]}], "-", 
     RowBox[{
      SubscriptBox["y", "1"], " ", 
      RowBox[{
       SubscriptBox["b", 
        RowBox[{"1", ",", "2"}]], "[", "t", "]"}]}], "+", 
     RowBox[{
      SubscriptBox["x", "2"], " ", 
      RowBox[{
       SubscriptBox["b", 
        RowBox[{"2", ",", "1"}]], "[", "t", "]"}]}], "-", 
     RowBox[{
      SubscriptBox["y", "2"], " ", 
      RowBox[{
       SubscriptBox["b", 
        RowBox[{"2", ",", "2"}]], "[", "t", "]"}]}], "+", 
     RowBox[{"u", " ", 
      RowBox[{
       SubscriptBox["b", 
        RowBox[{"3", ",", "1"}]], "[", "t", "]"}]}], "-", 
     RowBox[{"v", " ", 
      RowBox[{
       SubscriptBox["b", 
        RowBox[{"3", ",", "2"}]], "[", "t", "]"}]}], "+", 
     RowBox[{
      SubscriptBox["p", 
       RowBox[{"2", ",", "1"}]], "[", "t", "]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[Mu]", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["x", "1"], " ", 
          RowBox[{
           SubscriptBox["b", 
            RowBox[{"1", ",", "1"}]], "[", "t", "]"}]}], "-", 
         RowBox[{
          SubscriptBox["y", "1"], " ", 
          RowBox[{
           SubscriptBox["b", 
            RowBox[{"1", ",", "2"}]], "[", "t", "]"}]}], "+", 
         RowBox[{
          SubscriptBox["x", "2"], " ", 
          RowBox[{
           SubscriptBox["b", 
            RowBox[{"2", ",", "1"}]], "[", "t", "]"}]}], "-", 
         RowBox[{
          SubscriptBox["y", "2"], " ", 
          RowBox[{
           SubscriptBox["b", 
            RowBox[{"2", ",", "2"}]], "[", "t", "]"}]}], "+", 
         RowBox[{"u", " ", 
          RowBox[{
           SubscriptBox["b", 
            RowBox[{"3", ",", "1"}]], "[", "t", "]"}]}], "-", 
         RowBox[{"v", " ", 
          RowBox[{
           SubscriptBox["b", 
            RowBox[{"3", ",", "2"}]], "[", "t", "]"}]}], "+", 
         RowBox[{
          SubscriptBox["p", 
           RowBox[{"2", ",", "1"}]], "[", "t", "]"}]}], ")"}], "2"]}], "+", 
     RowBox[{"\[Nu]", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["y", "1"], " ", 
          RowBox[{
           SubscriptBox["b", 
            RowBox[{"1", ",", "1"}]], "[", "t", "]"}]}], "+", 
         RowBox[{
          SubscriptBox["x", "1"], " ", 
          RowBox[{
           SubscriptBox["b", 
            RowBox[{"1", ",", "2"}]], "[", "t", "]"}]}], "+", 
         RowBox[{
          SubscriptBox["y", "2"], " ", 
          RowBox[{
           SubscriptBox["b", 
            RowBox[{"2", ",", "1"}]], "[", "t", "]"}]}], "+", 
         RowBox[{
          SubscriptBox["x", "2"], " ", 
          RowBox[{
           SubscriptBox["b", 
            RowBox[{"2", ",", "2"}]], "[", "t", "]"}]}], "+", 
         RowBox[{"v", " ", 
          RowBox[{
           SubscriptBox["b", 
            RowBox[{"3", ",", "1"}]], "[", "t", "]"}]}], "+", 
         RowBox[{"u", " ", 
          RowBox[{
           SubscriptBox["b", 
            RowBox[{"3", ",", "2"}]], "[", "t", "]"}]}], "+", 
         RowBox[{
          SubscriptBox["p", 
           RowBox[{"2", ",", "2"}]], "[", "t", "]"}]}], ")"}], "2"]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{3.705945761938027*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"s", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     SubscriptBox["k", "3"]}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["y", "1"], " ", 
        RowBox[{
         SubscriptBox["a", 
          RowBox[{"1", ",", "1"}]], "[", "t", "]"}]}], "+", 
       RowBox[{
        SubscriptBox["x", "1"], " ", 
        RowBox[{
         SubscriptBox["a", 
          RowBox[{"1", ",", "2"}]], "[", "t", "]"}]}], "+", 
       RowBox[{
        SubscriptBox["y", "2"], " ", 
        RowBox[{
         SubscriptBox["a", 
          RowBox[{"2", ",", "1"}]], "[", "t", "]"}]}], "+", 
       RowBox[{
        SubscriptBox["x", "2"], " ", 
        RowBox[{
         SubscriptBox["a", 
          RowBox[{"2", ",", "2"}]], "[", "t", "]"}]}], "+", 
       RowBox[{"v", " ", 
        RowBox[{
         SubscriptBox["a", 
          RowBox[{"3", ",", "1"}]], "[", "t", "]"}]}], "+", 
       RowBox[{"u", " ", 
        RowBox[{
         SubscriptBox["a", 
          RowBox[{"3", ",", "2"}]], "[", "t", "]"}]}], "+", 
       RowBox[{
        SubscriptBox["p", 
         RowBox[{"1", ",", "2"}]], "[", "t", "]"}]}], ")"}], "2"]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", "2"], "[", "t", "]"}], "+", 
      RowBox[{
       SubscriptBox["y", "1"], " ", 
       RowBox[{
        SubscriptBox["c", 
         RowBox[{"1", ",", "1"}]], "[", "t", "]"}]}], "+", 
      RowBox[{
       SubscriptBox["x", "1"], " ", 
       RowBox[{
        SubscriptBox["c", 
         RowBox[{"1", ",", "2"}]], "[", "t", "]"}]}], "+", 
      RowBox[{
       SubscriptBox["y", "2"], " ", 
       RowBox[{
        SubscriptBox["c", 
         RowBox[{"2", ",", "1"}]], "[", "t", "]"}]}], "+", 
      RowBox[{
       SubscriptBox["x", "2"], " ", 
       RowBox[{
        SubscriptBox["c", 
         RowBox[{"2", ",", "2"}]], "[", "t", "]"}]}], "+", 
      RowBox[{"v", " ", 
       RowBox[{
        SubscriptBox["c", 
         RowBox[{"3", ",", "1"}]], "[", "t", "]"}]}], "+", 
      RowBox[{"u", " ", 
       RowBox[{
        SubscriptBox["c", 
         RowBox[{"3", ",", "2"}]], "[", "t", "]"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["x", "1"], " ", 
       RowBox[{
        SubscriptBox["b", 
         RowBox[{"1", ",", "1"}]], "[", "t", "]"}]}], "-", 
      RowBox[{
       SubscriptBox["y", "1"], " ", 
       RowBox[{
        SubscriptBox["b", 
         RowBox[{"1", ",", "2"}]], "[", "t", "]"}]}], "+", 
      RowBox[{
       SubscriptBox["x", "2"], " ", 
       RowBox[{
        SubscriptBox["b", 
         RowBox[{"2", ",", "1"}]], "[", "t", "]"}]}], "-", 
      RowBox[{
       SubscriptBox["y", "2"], " ", 
       RowBox[{
        SubscriptBox["b", 
         RowBox[{"2", ",", "2"}]], "[", "t", "]"}]}], "+", 
      RowBox[{"u", " ", 
       RowBox[{
        SubscriptBox["b", 
         RowBox[{"3", ",", "1"}]], "[", "t", "]"}]}], "-", 
      RowBox[{"v", " ", 
       RowBox[{
        SubscriptBox["b", 
         RowBox[{"3", ",", "2"}]], "[", "t", "]"}]}], "+", 
      RowBox[{
       SubscriptBox["p", 
        RowBox[{"2", ",", "1"}]], "[", "t", "]"}]}], ")"}]}], "-", 
   RowBox[{
    SubscriptBox["k", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["x", "1"], " ", 
       RowBox[{
        SubscriptBox["a", 
         RowBox[{"1", ",", "1"}]], "[", "t", "]"}]}], "-", 
      RowBox[{
       SubscriptBox["y", "1"], " ", 
       RowBox[{
        SubscriptBox["a", 
         RowBox[{"1", ",", "2"}]], "[", "t", "]"}]}], "+", 
      RowBox[{
       SubscriptBox["x", "2"], " ", 
       RowBox[{
        SubscriptBox["a", 
         RowBox[{"2", ",", "1"}]], "[", "t", "]"}]}], "-", 
      RowBox[{
       SubscriptBox["y", "2"], " ", 
       RowBox[{
        SubscriptBox["a", 
         RowBox[{"2", ",", "2"}]], "[", "t", "]"}]}], "+", 
      RowBox[{"u", " ", 
       RowBox[{
        SubscriptBox["a", 
         RowBox[{"3", ",", "1"}]], "[", "t", "]"}]}], "-", 
      RowBox[{"v", " ", 
       RowBox[{
        SubscriptBox["a", 
         RowBox[{"3", ",", "2"}]], "[", "t", "]"}]}], "+", 
      RowBox[{
       SubscriptBox["p", 
        RowBox[{"1", ",", "1"}]], "[", "t", "]"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["y", "1"], " ", 
       RowBox[{
        SubscriptBox["b", 
         RowBox[{"1", ",", "1"}]], "[", "t", "]"}]}], "+", 
      RowBox[{
       SubscriptBox["x", "1"], " ", 
       RowBox[{
        SubscriptBox["b", 
         RowBox[{"1", ",", "2"}]], "[", "t", "]"}]}], "+", 
      RowBox[{
       SubscriptBox["y", "2"], " ", 
       RowBox[{
        SubscriptBox["b", 
         RowBox[{"2", ",", "1"}]], "[", "t", "]"}]}], "+", 
      RowBox[{
       SubscriptBox["x", "2"], " ", 
       RowBox[{
        SubscriptBox["b", 
         RowBox[{"2", ",", "2"}]], "[", "t", "]"}]}], "+", 
      RowBox[{"v", " ", 
       RowBox[{
        SubscriptBox["b", 
         RowBox[{"3", ",", "1"}]], "[", "t", "]"}]}], "+", 
      RowBox[{"u", " ", 
       RowBox[{
        SubscriptBox["b", 
         RowBox[{"3", ",", "2"}]], "[", "t", "]"}]}], "+", 
      RowBox[{
       SubscriptBox["p", 
        RowBox[{"2", ",", "2"}]], "[", "t", "]"}]}], ")"}]}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["x", "1"], " ", 
       RowBox[{
        SubscriptBox["b", 
         RowBox[{"1", ",", "1"}]], "[", "t", "]"}]}], "-", 
      RowBox[{
       SubscriptBox["y", "1"], " ", 
       RowBox[{
        SubscriptBox["b", 
         RowBox[{"1", ",", "2"}]], "[", "t", "]"}]}], "+", 
      RowBox[{
       SubscriptBox["x", "2"], " ", 
       RowBox[{
        SubscriptBox["b", 
         RowBox[{"2", ",", "1"}]], "[", "t", "]"}]}], "-", 
      RowBox[{
       SubscriptBox["y", "2"], " ", 
       RowBox[{
        SubscriptBox["b", 
         RowBox[{"2", ",", "2"}]], "[", "t", "]"}]}], "+", 
      RowBox[{"u", " ", 
       RowBox[{
        SubscriptBox["b", 
         RowBox[{"3", ",", "1"}]], "[", "t", "]"}]}], "-", 
      RowBox[{"v", " ", 
       RowBox[{
        SubscriptBox["b", 
         RowBox[{"3", ",", "2"}]], "[", "t", "]"}]}], "+", 
      RowBox[{
       SubscriptBox["p", 
        RowBox[{"2", ",", "1"}]], "[", "t", "]"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Mu]", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["x", "1"], " ", 
           RowBox[{
            SubscriptBox["b", 
             RowBox[{"1", ",", "1"}]], "[", "t", "]"}]}], "-", 
          RowBox[{
           SubscriptBox["y", "1"], " ", 
           RowBox[{
            SubscriptBox["b", 
             RowBox[{"1", ",", "2"}]], "[", "t", "]"}]}], "+", 
          RowBox[{
           SubscriptBox["x", "2"], " ", 
           RowBox[{
            SubscriptBox["b", 
             RowBox[{"2", ",", "1"}]], "[", "t", "]"}]}], "-", 
          RowBox[{
           SubscriptBox["y", "2"], " ", 
           RowBox[{
            SubscriptBox["b", 
             RowBox[{"2", ",", "2"}]], "[", "t", "]"}]}], "+", 
          RowBox[{"u", " ", 
           RowBox[{
            SubscriptBox["b", 
             RowBox[{"3", ",", "1"}]], "[", "t", "]"}]}], "-", 
          RowBox[{"v", " ", 
           RowBox[{
            SubscriptBox["b", 
             RowBox[{"3", ",", "2"}]], "[", "t", "]"}]}], "+", 
          RowBox[{
           SubscriptBox["p", 
            RowBox[{"2", ",", "1"}]], "[", "t", "]"}]}], ")"}], "2"]}], "+", 
      RowBox[{"\[Nu]", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox["y", "1"], " ", 
           RowBox[{
            SubscriptBox["b", 
             RowBox[{"1", ",", "1"}]], "[", "t", "]"}]}], "+", 
          RowBox[{
           SubscriptBox["x", "1"], " ", 
           RowBox[{
            SubscriptBox["b", 
             RowBox[{"1", ",", "2"}]], "[", "t", "]"}]}], "+", 
          RowBox[{
           SubscriptBox["y", "2"], " ", 
           RowBox[{
            SubscriptBox["b", 
             RowBox[{"2", ",", "1"}]], "[", "t", "]"}]}], "+", 
          RowBox[{
           SubscriptBox["x", "2"], " ", 
           RowBox[{
            SubscriptBox["b", 
             RowBox[{"2", ",", "2"}]], "[", "t", "]"}]}], "+", 
          RowBox[{"v", " ", 
           RowBox[{
            SubscriptBox["b", 
             RowBox[{"3", ",", "1"}]], "[", "t", "]"}]}], "+", 
          RowBox[{"u", " ", 
           RowBox[{
            SubscriptBox["b", 
             RowBox[{"3", ",", "2"}]], "[", "t", "]"}]}], "+", 
          RowBox[{
           SubscriptBox["p", 
            RowBox[{"2", ",", "2"}]], "[", "t", "]"}]}], ")"}], "2"]}]}], 
     ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7059457714609623`*^9, 3.705945772548622*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    SubscriptBox["k", "3"]}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["y", "1"], " ", 
       RowBox[{
        SubscriptBox["a", 
         RowBox[{"1", ",", "1"}]], "[", "t", "]"}]}], "+", 
      RowBox[{
       SubscriptBox["x", "1"], " ", 
       RowBox[{
        SubscriptBox["a", 
         RowBox[{"1", ",", "2"}]], "[", "t", "]"}]}], "+", 
      RowBox[{
       SubscriptBox["y", "2"], " ", 
       RowBox[{
        SubscriptBox["a", 
         RowBox[{"2", ",", "1"}]], "[", "t", "]"}]}], "+", 
      RowBox[{
       SubscriptBox["x", "2"], " ", 
       RowBox[{
        SubscriptBox["a", 
         RowBox[{"2", ",", "2"}]], "[", "t", "]"}]}], "+", 
      RowBox[{"v", " ", 
       RowBox[{
        SubscriptBox["a", 
         RowBox[{"3", ",", "1"}]], "[", "t", "]"}]}], "+", 
      RowBox[{"u", " ", 
       RowBox[{
        SubscriptBox["a", 
         RowBox[{"3", ",", "2"}]], "[", "t", "]"}]}], "+", 
      RowBox[{
       SubscriptBox["p", 
        RowBox[{"1", ",", "2"}]], "[", "t", "]"}]}], ")"}], "2"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox["q", "2"], "[", "t", "]"}], "+", 
     RowBox[{
      SubscriptBox["y", "1"], " ", 
      RowBox[{
       SubscriptBox["c", 
        RowBox[{"1", ",", "1"}]], "[", "t", "]"}]}], "+", 
     RowBox[{
      SubscriptBox["x", "1"], " ", 
      RowBox[{
       SubscriptBox["c", 
        RowBox[{"1", ",", "2"}]], "[", "t", "]"}]}], "+", 
     RowBox[{
      SubscriptBox["y", "2"], " ", 
      RowBox[{
       SubscriptBox["c", 
        RowBox[{"2", ",", "1"}]], "[", "t", "]"}]}], "+", 
     RowBox[{
      SubscriptBox["x", "2"], " ", 
      RowBox[{
       SubscriptBox["c", 
        RowBox[{"2", ",", "2"}]], "[", "t", "]"}]}], "+", 
     RowBox[{"v", " ", 
      RowBox[{
       SubscriptBox["c", 
        RowBox[{"3", ",", "1"}]], "[", "t", "]"}]}], "+", 
     RowBox[{"u", " ", 
      RowBox[{
       SubscriptBox["c", 
        RowBox[{"3", ",", "2"}]], "[", "t", "]"}]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox["x", "1"], " ", 
      RowBox[{
       SubscriptBox["b", 
        RowBox[{"1", ",", "1"}]], "[", "t", "]"}]}], "-", 
     RowBox[{
      SubscriptBox["y", "1"], " ", 
      RowBox[{
       SubscriptBox["b", 
        RowBox[{"1", ",", "2"}]], "[", "t", "]"}]}], "+", 
     RowBox[{
      SubscriptBox["x", "2"], " ", 
      RowBox[{
       SubscriptBox["b", 
        RowBox[{"2", ",", "1"}]], "[", "t", "]"}]}], "-", 
     RowBox[{
      SubscriptBox["y", "2"], " ", 
      RowBox[{
       SubscriptBox["b", 
        RowBox[{"2", ",", "2"}]], "[", "t", "]"}]}], "+", 
     RowBox[{"u", " ", 
      RowBox[{
       SubscriptBox["b", 
        RowBox[{"3", ",", "1"}]], "[", "t", "]"}]}], "-", 
     RowBox[{"v", " ", 
      RowBox[{
       SubscriptBox["b", 
        RowBox[{"3", ",", "2"}]], "[", "t", "]"}]}], "+", 
     RowBox[{
      SubscriptBox["p", 
       RowBox[{"2", ",", "1"}]], "[", "t", "]"}]}], ")"}]}], "-", 
  RowBox[{
   SubscriptBox["k", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox["x", "1"], " ", 
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"1", ",", "1"}]], "[", "t", "]"}]}], "-", 
     RowBox[{
      SubscriptBox["y", "1"], " ", 
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"1", ",", "2"}]], "[", "t", "]"}]}], "+", 
     RowBox[{
      SubscriptBox["x", "2"], " ", 
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"2", ",", "1"}]], "[", "t", "]"}]}], "-", 
     RowBox[{
      SubscriptBox["y", "2"], " ", 
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"2", ",", "2"}]], "[", "t", "]"}]}], "+", 
     RowBox[{"u", " ", 
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"3", ",", "1"}]], "[", "t", "]"}]}], "-", 
     RowBox[{"v", " ", 
      RowBox[{
       SubscriptBox["a", 
        RowBox[{"3", ",", "2"}]], "[", "t", "]"}]}], "+", 
     RowBox[{
      SubscriptBox["p", 
       RowBox[{"1", ",", "1"}]], "[", "t", "]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox["y", "1"], " ", 
      RowBox[{
       SubscriptBox["b", 
        RowBox[{"1", ",", "1"}]], "[", "t", "]"}]}], "+", 
     RowBox[{
      SubscriptBox["x", "1"], " ", 
      RowBox[{
       SubscriptBox["b", 
        RowBox[{"1", ",", "2"}]], "[", "t", "]"}]}], "+", 
     RowBox[{
      SubscriptBox["y", "2"], " ", 
      RowBox[{
       SubscriptBox["b", 
        RowBox[{"2", ",", "1"}]], "[", "t", "]"}]}], "+", 
     RowBox[{
      SubscriptBox["x", "2"], " ", 
      RowBox[{
       SubscriptBox["b", 
        RowBox[{"2", ",", "2"}]], "[", "t", "]"}]}], "+", 
     RowBox[{"v", " ", 
      RowBox[{
       SubscriptBox["b", 
        RowBox[{"3", ",", "1"}]], "[", "t", "]"}]}], "+", 
     RowBox[{"u", " ", 
      RowBox[{
       SubscriptBox["b", 
        RowBox[{"3", ",", "2"}]], "[", "t", "]"}]}], "+", 
     RowBox[{
      SubscriptBox["p", 
       RowBox[{"2", ",", "2"}]], "[", "t", "]"}]}], ")"}]}], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox["x", "1"], " ", 
      RowBox[{
       SubscriptBox["b", 
        RowBox[{"1", ",", "1"}]], "[", "t", "]"}]}], "-", 
     RowBox[{
      SubscriptBox["y", "1"], " ", 
      RowBox[{
       SubscriptBox["b", 
        RowBox[{"1", ",", "2"}]], "[", "t", "]"}]}], "+", 
     RowBox[{
      SubscriptBox["x", "2"], " ", 
      RowBox[{
       SubscriptBox["b", 
        RowBox[{"2", ",", "1"}]], "[", "t", "]"}]}], "-", 
     RowBox[{
      SubscriptBox["y", "2"], " ", 
      RowBox[{
       SubscriptBox["b", 
        RowBox[{"2", ",", "2"}]], "[", "t", "]"}]}], "+", 
     RowBox[{"u", " ", 
      RowBox[{
       SubscriptBox["b", 
        RowBox[{"3", ",", "1"}]], "[", "t", "]"}]}], "-", 
     RowBox[{"v", " ", 
      RowBox[{
       SubscriptBox["b", 
        RowBox[{"3", ",", "2"}]], "[", "t", "]"}]}], "+", 
     RowBox[{
      SubscriptBox["p", 
       RowBox[{"2", ",", "1"}]], "[", "t", "]"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[Mu]", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["x", "1"], " ", 
          RowBox[{
           SubscriptBox["b", 
            RowBox[{"1", ",", "1"}]], "[", "t", "]"}]}], "-", 
         RowBox[{
          SubscriptBox["y", "1"], " ", 
          RowBox[{
           SubscriptBox["b", 
            RowBox[{"1", ",", "2"}]], "[", "t", "]"}]}], "+", 
         RowBox[{
          SubscriptBox["x", "2"], " ", 
          RowBox[{
           SubscriptBox["b", 
            RowBox[{"2", ",", "1"}]], "[", "t", "]"}]}], "-", 
         RowBox[{
          SubscriptBox["y", "2"], " ", 
          RowBox[{
           SubscriptBox["b", 
            RowBox[{"2", ",", "2"}]], "[", "t", "]"}]}], "+", 
         RowBox[{"u", " ", 
          RowBox[{
           SubscriptBox["b", 
            RowBox[{"3", ",", "1"}]], "[", "t", "]"}]}], "-", 
         RowBox[{"v", " ", 
          RowBox[{
           SubscriptBox["b", 
            RowBox[{"3", ",", "2"}]], "[", "t", "]"}]}], "+", 
         RowBox[{
          SubscriptBox["p", 
           RowBox[{"2", ",", "1"}]], "[", "t", "]"}]}], ")"}], "2"]}], "+", 
     RowBox[{"\[Nu]", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["y", "1"], " ", 
          RowBox[{
           SubscriptBox["b", 
            RowBox[{"1", ",", "1"}]], "[", "t", "]"}]}], "+", 
         RowBox[{
          SubscriptBox["x", "1"], " ", 
          RowBox[{
           SubscriptBox["b", 
            RowBox[{"1", ",", "2"}]], "[", "t", "]"}]}], "+", 
         RowBox[{
          SubscriptBox["y", "2"], " ", 
          RowBox[{
           SubscriptBox["b", 
            RowBox[{"2", ",", "1"}]], "[", "t", "]"}]}], "+", 
         RowBox[{
          SubscriptBox["x", "2"], " ", 
          RowBox[{
           SubscriptBox["b", 
            RowBox[{"2", ",", "2"}]], "[", "t", "]"}]}], "+", 
         RowBox[{"v", " ", 
          RowBox[{
           SubscriptBox["b", 
            RowBox[{"3", ",", "1"}]], "[", "t", "]"}]}], "+", 
         RowBox[{"u", " ", 
          RowBox[{
           SubscriptBox["b", 
            RowBox[{"3", ",", "2"}]], "[", "t", "]"}]}], "+", 
         RowBox[{
          SubscriptBox["p", 
           RowBox[{"2", ",", "2"}]], "[", "t", "]"}]}], ")"}], "2"]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{{3.70594576475377*^9, 3.7059457729715014`*^9}}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"S", " ", "=", 
   RowBox[{
    RowBox[{"v", "*", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SubscriptBox["x", "2"]}], ")"}]}], "\[Equal]", 
    RowBox[{
     SuperscriptBox[
      SubscriptBox["x", "1"], "2"], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SubscriptBox["x", "2"]}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Mu]", " ", 
         SubsuperscriptBox["x", "2", "2"]}], "+", 
        RowBox[{"\[Nu]", " ", 
         SubsuperscriptBox["y", "2", "2"]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SubscriptBox["x", "2"]}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "*", "\[Mu]", " ", "*", 
         SubscriptBox["x", "2"]}], "+", 
        RowBox[{"\[Lambda]", "*", 
         SubscriptBox["y", "2"]}]}], ")"}]}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", GridBox[{
         {"1", "0", "0"},
         {"0", "1", "0"},
         {"0", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]", "+", 
            RowBox[{"2", "*", "\[Mu]", "*", "I"}]}], ")"}], "1"}
        }], ")"}], ".", 
      RowBox[{"(", GridBox[{
         {
          SubscriptBox["z", "1"]},
         {
          SubscriptBox["z", "2"]},
         {"w"}
        }], ")"}]}], "+", 
     RowBox[{"(", GridBox[{
        {"0"},
        {"0"},
        {"0"}
       }], ")"}]}], "/.", "transformSubstitutions"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.705947643145384*^9, 3.7059476858474007`*^9}, {
  3.705947896125185*^9, 3.705947962764626*^9}, {3.70594802181295*^9, 
  3.705948119792014*^9}, {3.7059486360709953`*^9, 3.705948692672282*^9}, {
  3.70594902739073*^9, 3.7059490834508133`*^9}, {3.7059501412795153`*^9, 
  3.705950165363626*^9}, {3.705950515340927*^9, 3.705950516803356*^9}, {
  3.70595646977323*^9, 3.705956502465081*^9}, {3.705956540839053*^9, 
  3.705956545366736*^9}, {3.705956589193453*^9, 3.705956620261153*^9}, {
  3.705956663203723*^9, 3.705956678216342*^9}, {3.705956750290941*^9, 
  3.705956781460527*^9}, {3.705956814539291*^9, 3.705956838927589*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "@", 
  RowBox[{"TransformSurface", "[", 
   RowBox[{"S", ",", " ", "T"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.705947689273368*^9, 3.705947696134404*^9}, {
   3.7059480484538813`*^9, 3.705948049832655*^9}, {3.7059486568017683`*^9, 
   3.705948657691235*^9}, {3.705948696121019*^9, 3.70594869711512*^9}, 
   3.7059490692370777`*^9, {3.705950174766618*^9, 3.705950199714683*^9}, {
   3.705950267201557*^9, 3.7059502894315023`*^9}, 3.7059503210770617`*^9, {
   3.70595046135297*^9, 3.705950462848003*^9}, {3.705950522613852*^9, 
   3.705950536182201*^9}, {3.705956554208197*^9, 3.7059565760285187`*^9}, {
   3.7059567735956306`*^9, 3.7059567769973803`*^9}, {3.705956818692136*^9, 
   3.705956825243682*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubsuperscriptBox["x", "1", "2"], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SubscriptBox["x", "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "v"}], "+", 
      RowBox[{"\[Mu]", " ", 
       SubsuperscriptBox["x", "2", "2"]}], "+", 
      RowBox[{"\[Nu]", " ", 
       SubsuperscriptBox["y", "2", "2"]}]}], ")"}]}]}], "\[Equal]", 
  "0"}]], "Output",
 CellChangeTimes->{
  3.705947696396574*^9, {3.705947923001549*^9, 3.7059479399009733`*^9}, 
   3.7059479701336737`*^9, {3.7059480315277452`*^9, 3.705948121296219*^9}, {
   3.705948652908605*^9, 3.705948698310391*^9}, {3.7059490522178917`*^9, 
   3.705949085678944*^9}, {3.7059501687753963`*^9, 3.70595020003365*^9}, {
   3.705950260818109*^9, 3.705950290001318*^9}, 3.7059503213293324`*^9, 
   3.7059504631818247`*^9, {3.705950518723939*^9, 3.705950538350253*^9}, 
   3.705956507522634*^9, {3.705956548986631*^9, 3.705956576962036*^9}, 
   3.705956622655819*^9, 3.7059566659486856`*^9, {3.705956765573995*^9, 
   3.705956783276539*^9}, {3.70595681631376*^9, 3.705956840643441*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"v", "+", 
   RowBox[{"v", " ", 
    SubscriptBox["x", "2"]}]}], "\[Equal]", 
  RowBox[{
   RowBox[{"2", "\[Mu]", " ", 
    SubscriptBox["x", "2"]}], "+", 
   RowBox[{"3", " ", "\[Mu]", " ", 
    SubsuperscriptBox["x", "2", "2"]}], "+", 
   RowBox[{"\[Mu]", " ", 
    SubsuperscriptBox["x", "2", "3"]}], "+", 
   RowBox[{"\[Lambda]", " ", 
    SubscriptBox["x", "1"], " ", 
    SubscriptBox["y", "1"]}], "+", 
   RowBox[{"\[Lambda]", " ", 
    SubscriptBox["x", "1"], " ", 
    SubscriptBox["x", "2"], " ", 
    SubscriptBox["y", "1"]}], "+", 
   RowBox[{"\[Nu]", " ", 
    SubsuperscriptBox["y", "2", "2"]}], "+", 
   RowBox[{"\[Nu]", " ", 
    SubscriptBox["x", "2"], " ", 
    SubsuperscriptBox["y", "2", "2"]}]}]}]], "Input",
 CellChangeTimes->{{3.705950301259645*^9, 3.705950304266162*^9}, {
  3.705950353008438*^9, 3.705950375442696*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"v", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     SubscriptBox["x", "2"]}], ")"}]}], "\[Equal]", 
  RowBox[{
   SubsuperscriptBox["x", "1", "2"], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SubscriptBox["x", "2"]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Mu]", " ", 
       SubsuperscriptBox["x", "2", "2"]}], "+", 
      RowBox[{"\[Lambda]", " ", 
       SubscriptBox["x", "1"], " ", 
       SubscriptBox["y", "1"]}], "+", 
      RowBox[{"\[Nu]", " ", 
       SubsuperscriptBox["y", "2", "2"]}]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SubscriptBox["x", "2"]}], ")"}], 
    RowBox[{"(", 
     RowBox[{"2", " ", "\[Mu]", " ", 
      SubscriptBox["x", "2"]}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7059503352463713`*^9, 3.7059503733713417`*^9}, {
  3.7059504268031883`*^9, 3.705950448715476*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"2", "\[Mu]", " ", 
    SubscriptBox["x", "2"]}], "+", 
   RowBox[{"3", " ", "\[Mu]", " ", 
    SubsuperscriptBox["x", "2", "2"]}], "+", 
   RowBox[{"\[Mu]", " ", 
    SubsuperscriptBox["x", "2", "3"]}], "+", 
   RowBox[{"\[Lambda]", " ", 
    SubscriptBox["x", "1"], " ", 
    SubscriptBox["y", "1"]}], "+", 
   RowBox[{"\[Lambda]", " ", 
    SubscriptBox["x", "1"], " ", 
    SubscriptBox["x", "2"], " ", 
    SubscriptBox["y", "1"]}], "+", 
   RowBox[{"\[Nu]", " ", 
    SubsuperscriptBox["y", "2", "2"]}], "+", 
   RowBox[{"\[Nu]", " ", 
    SubscriptBox["x", "2"], " ", 
    SubsuperscriptBox["y", "2", "2"]}]}], 
  SubscriptBox["x", "2"]]], "Input",
 CellChangeTimes->{{3.705950380250873*^9, 3.705950398945855*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", "%1696", "]"}]], "Input",
 NumberMarks->False],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", "\[Mu]", " ", 
   SubscriptBox["x", "2"]}], "+", 
  RowBox[{"\[Mu]", " ", 
   SubsuperscriptBox["x", "2", "2"]}], "+", 
  RowBox[{"\[Lambda]", " ", 
   SubscriptBox["x", "1"], " ", 
   SubscriptBox["y", "1"]}], "+", 
  RowBox[{"\[Nu]", " ", 
   SubsuperscriptBox["y", "2", "2"]}]}]], "Output",
 CellChangeTimes->{3.70595041507476*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"v", "+", 
   RowBox[{"v", " ", 
    SubscriptBox["x", "2"]}]}], "\[Equal]", 
  RowBox[{
   SubsuperscriptBox["x", "1", "2"], "+", 
   RowBox[{"2", " ", "\[Mu]", " ", 
    SubscriptBox["x", "2"]}], "+", 
   RowBox[{"3", " ", "\[Mu]", " ", 
    SubsuperscriptBox["x", "2", "2"]}], "+", 
   RowBox[{"\[Mu]", " ", 
    SubsuperscriptBox["x", "2", "3"]}], "+", 
   RowBox[{"\[Lambda]", " ", 
    SubscriptBox["x", "1"], " ", 
    SubscriptBox["y", "1"]}], "+", 
   RowBox[{"\[Lambda]", " ", 
    SubscriptBox["x", "1"], " ", 
    SubscriptBox["x", "2"], " ", 
    SubscriptBox["y", "1"]}], "+", 
   RowBox[{"\[Nu]", " ", 
    SubsuperscriptBox["y", "2", "2"]}], "+", 
   RowBox[{"\[Nu]", " ", 
    SubscriptBox["x", "2"], " ", 
    SubsuperscriptBox["y", "2", "2"]}]}]}]], "Input",
 CellChangeTimes->{{3.705950485694512*^9, 3.7059505011006107`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubsuperscriptBox["x", "1", "2"], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SubscriptBox["x", "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "v"}], "+", 
      RowBox[{"2", " ", "\[Mu]", " ", 
       SubscriptBox["x", "2"]}], "+", 
      RowBox[{"\[Mu]", " ", 
       SubsuperscriptBox["x", "2", "2"]}], "+", 
      RowBox[{"\[Lambda]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["x", "2"]}], ")"}], " ", 
       SubscriptBox["y", "2"]}], "+", 
      RowBox[{"\[Nu]", " ", 
       SubsuperscriptBox["y", "2", "2"]}]}], ")"}]}]}], "\[Equal]", 
  "0"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TeXForm", "[", 
  RowBox[{
   RowBox[{"v", "*", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SubscriptBox["x", "1"]}], ")"}]}], "\[Equal]", 
   RowBox[{
    SuperscriptBox[
     SubscriptBox["x", "1"], "2"], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SubscriptBox["x", "2"]}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Mu]", " ", 
        SubsuperscriptBox["x", "2", "2"]}], "+", 
       RowBox[{"\[Nu]", " ", 
        SubsuperscriptBox["y", "2", "2"]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SubscriptBox["x", "2"]}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "*", "\[Mu]", " ", "*", 
        SubscriptBox["x", "2"]}], "+", 
       RowBox[{"\[Lambda]", "*", 
        SubscriptBox["y", "2"]}]}], ")"}]}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.705950546049247*^9, 3.7059505879244204`*^9}, {
  3.705950633279698*^9, 3.705950651526453*^9}, {3.705956396797659*^9, 
  3.7059564048403463`*^9}}],

Cell["\<\
v \\left(x_1+1\\right)=\\left(x_2+1\\right) \\left(2 \\mu  x_2+\\lambda  \
y_2\\right)+\\left(x_2+1\\right) \\left(\\mu  x_2^2+\\nu  y_2^2\\right)+x_1^2\
\
\>", "Output",
 CellChangeTimes->{3.70595065231177*^9, 3.705956405098411*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PrintMatrix", "@", 
  RowBox[{"ComplexExpand", "@", 
   RowBox[{"Im", "@", 
    RowBox[{"CreateTransform", "[", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.705956693297964*^9, 3.7059567341553907`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       StyleBox["\[Null]",
        ShowStringCharacters->False], 
       TagBox["1",
        HoldForm]},
      {
       TagBox["1",
        HoldForm], 
       RowBox[{
        RowBox[{
         SubscriptBox["y", "1"], " ", 
         SubscriptBox["a", 
          RowBox[{"1", ",", "1"}]]}], "+", 
        RowBox[{
         SubscriptBox["x", "1"], " ", 
         SubscriptBox["a", 
          RowBox[{"1", ",", "2"}]]}], "+", 
        RowBox[{
         SubscriptBox["y", "2"], " ", 
         SubscriptBox["a", 
          RowBox[{"2", ",", "1"}]]}], "+", 
        RowBox[{
         SubscriptBox["x", "2"], " ", 
         SubscriptBox["a", 
          RowBox[{"2", ",", "2"}]]}], "+", 
        RowBox[{"v", " ", 
         SubscriptBox["a", 
          RowBox[{"3", ",", "1"}]]}], "+", 
        RowBox[{"u", " ", 
         SubscriptBox["a", 
          RowBox[{"3", ",", "2"}]]}], "+", 
        SubscriptBox["p", 
         RowBox[{"1", ",", "2"}]]}]},
      {
       TagBox["2",
        HoldForm], 
       RowBox[{
        RowBox[{
         SubscriptBox["y", "1"], " ", 
         SubscriptBox["b", 
          RowBox[{"1", ",", "1"}]]}], "+", 
        RowBox[{
         SubscriptBox["x", "1"], " ", 
         SubscriptBox["b", 
          RowBox[{"1", ",", "2"}]]}], "+", 
        RowBox[{
         SubscriptBox["y", "2"], " ", 
         SubscriptBox["b", 
          RowBox[{"2", ",", "1"}]]}], "+", 
        RowBox[{
         SubscriptBox["x", "2"], " ", 
         SubscriptBox["b", 
          RowBox[{"2", ",", "2"}]]}], "+", 
        RowBox[{"v", " ", 
         SubscriptBox["b", 
          RowBox[{"3", ",", "1"}]]}], "+", 
        RowBox[{"u", " ", 
         SubscriptBox["b", 
          RowBox[{"3", ",", "2"}]]}], "+", 
        SubscriptBox["p", 
         RowBox[{"2", ",", "2"}]]}]},
      {
       TagBox["3",
        HoldForm], 
       RowBox[{
        SubscriptBox["q", "2"], "+", 
        RowBox[{
         SubscriptBox["y", "1"], " ", 
         SubscriptBox["c", 
          RowBox[{"1", ",", "1"}]]}], "+", 
        RowBox[{
         SubscriptBox["x", "1"], " ", 
         SubscriptBox["c", 
          RowBox[{"1", ",", "2"}]]}], "+", 
        RowBox[{
         SubscriptBox["y", "2"], " ", 
         SubscriptBox["c", 
          RowBox[{"2", ",", "1"}]]}], "+", 
        RowBox[{
         SubscriptBox["x", "2"], " ", 
         SubscriptBox["c", 
          RowBox[{"2", ",", "2"}]]}], "+", 
        RowBox[{"v", " ", 
         SubscriptBox["c", 
          RowBox[{"3", ",", "1"}]]}], "+", 
        RowBox[{"u", " ", 
         SubscriptBox["c", 
          RowBox[{"3", ",", "2"}]]}]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {False, True, {False}, False}, "ColumnsIndexed" -> {}, 
       "Rows" -> {False, True, {False}, False}, "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.7]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    {OutputFormsDump`HeadedRows, OutputFormsDump`HeadedColumns}], 
   "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$, TableHeadings -> {{1, 2, 3}, {1}}]]]], "Output",
 CellChangeTimes->{{3.705956700542511*^9, 3.705956734441196*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "@", 
  RowBox[{"DeleteDuplicates", "[", "system", "]"}]}]], "Input",
 CellChangeTimes->{{3.705957895083027*^9, 3.705957908988716*^9}}],

Cell[BoxData["61"], "Output",
 CellChangeTimes->{{3.7059579016660748`*^9, 3.705957909349517*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TeXForm", "@", 
  RowBox[{"FullSimplify", "@", 
   RowBox[{"ITs", "[", 
    RowBox[{"[", "4", "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7059595623931026`*^9, 3.705959570572106*^9}, {
  3.705959618307856*^9, 3.705959635770667*^9}, {3.705959739181828*^9, 
  3.7059597502845707`*^9}, {3.705959794732595*^9, 3.705959827483871*^9}, {
  3.705960508381983*^9, 3.705960554262198*^9}}],

Cell["\<\
\\left(
\\begin{array}{cccc}
 0 & 0 & 0 & i \\\\
 0 & 0 & 0 & 0 \\\\
 0 & 0 & 0 & 0 \\\\
 0 & 0 & 0 & 0 \\\\
\\end{array}
\\right)\
\>", "Output",
 CellChangeTimes->{{3.7059595710053387`*^9, 3.7059595884811773`*^9}, {
  3.705959626985219*^9, 3.7059596360797853`*^9}, {3.705959740395638*^9, 
  3.7059597505305777`*^9}, {3.705959795090466*^9, 3.7059598278191957`*^9}, {
  3.705960510949751*^9, 3.705960536135944*^9}}]
}, Open  ]]
},
WindowSize->{1280, 751},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 35086, 928, 2981, "Input"],
Cell[CellGroupData[{
Cell[35669, 952, 3919, 96, 392, "Input"],
Cell[CellGroupData[{
Cell[39613, 1052, 618, 11, 24, "Print"],
Cell[40234, 1065, 566, 10, 24, "Print"]
}, Open  ]],
Cell[40815, 1078, 271, 6, 24, "Message"],
Cell[CellGroupData[{
Cell[41111, 1088, 488, 9, 24, "Print"],
Cell[41602, 1099, 361, 4, 24, "Print"]
}, Open  ]],
Cell[41978, 1106, 7985, 245, 119, "Output"],
Cell[49966, 1353, 327, 4, 24, "Print"],
Cell[50296, 1359, 9567, 288, 117, "Output"],
Cell[59866, 1649, 487, 9, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60390, 1663, 178, 3, 46, "Input"],
Cell[60571, 1668, 9098, 333, 1041, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69706, 2006, 7097, 226, 129, "Input"],
Cell[76806, 2234, 8520, 280, 130, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[85363, 2519, 8846, 281, 153, "Input"],
Cell[94212, 2802, 8545, 280, 130, "Output"]
}, Open  ]],
Cell[102772, 3085, 2199, 65, 91, "Input"],
Cell[CellGroupData[{
Cell[104996, 3154, 748, 12, 46, "Input"],
Cell[105747, 3168, 1119, 25, 35, "Output"]
}, Open  ]],
Cell[106881, 3196, 878, 25, 34, "Input"],
Cell[107762, 3223, 914, 29, 35, "Input"],
Cell[108679, 3254, 771, 22, 55, "Input"],
Cell[CellGroupData[{
Cell[109475, 3280, 86, 2, 46, "Input"],
Cell[109564, 3284, 378, 11, 34, "Output"]
}, Open  ]],
Cell[109957, 3298, 879, 25, 34, "Input"],
Cell[110839, 3325, 681, 22, 35, "Input"],
Cell[CellGroupData[{
Cell[111545, 3351, 1034, 32, 48, "Input"],
Cell[112582, 3385, 243, 5, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[112862, 3395, 226, 5, 46, "Input"],
Cell[113091, 3402, 3510, 110, 91, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[116638, 3517, 168, 3, 46, "Input"],
Cell[116809, 3522, 97, 1, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[116943, 3528, 408, 8, 46, "Input"],
Cell[117354, 3538, 425, 13, 169, "Output"]
}, Open  ]]
}
]
*)

