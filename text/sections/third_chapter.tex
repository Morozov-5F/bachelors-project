% !TEX root = ../main.tex
\documentclass[../main.tex]{subfiles}
\begin{document}

В данном разделе будет описана процедура определения размерностей групп аффинных преобразований для семейства поверхностей~(\ref{eq:initial}).
\subsection{Общая схема}
Основываясь на сведениях из раздела 2, можно сформулировать следующий алгоритм для нахождения размерности групп аффинных преобразований, сохраняющих поверхности из семейства~(\ref{eq:initial}):
\begin{enumerate}
\item Применить аффинное преобразование~(\ref{eq:affine_transform}) к уравнению поверхности
\item Продифференцировать полученное выражение по параметру группы $t$ в точке $t = 0$.
\item Разрешить уравнение поверхности относительно переменной $v$ и подставить в выражение и предыдущего шага и умножить на возникающий общий знаменатель ($x_2^2$).
\item Составить однородную систему линейных относительно элементов инфинитезимального преобразования уравнений и выписать матрицу этой системы.
\item Размерность группы Ли аффинных преобразований $G$, сохраняющих поверхность из исследуемого семейства, равна $\dim G = 24 - \mathrm{rank}~W$, где $W$ "--- полученная матрица системы.
\end{enumerate}

%%%%%%
\subsection{Частный случай семейства}
В связи со сложностью рассмотрения общего случая, был рассмотрен частный случай семейства поверхностей~(\ref{eq:initial}), в котором квадратичная форма $Q$ не зависит от переменных $x_2$ и $y_2$. В таком случае, семейство может быть описано следующим образом:
\begin{equation}\label{eq:special}
v x_2 = k_1 x_1^2 + k_2 x_1 y_1 + k_3 x_2^2 + x_2 (\mu x_2^2 + \nu y_2^2),
\end{equation}

Следует заметить, что за счёт применения невырожденных аффинных преобразований, можно фактически сократить число параметров $k_1, k_2$ и $k_3$ до одного:

Применим описанный метод для этого класса поверхностей.

\begin{enumerate}
\item Применим аффинное преобразование к определяющей функции поверхности из семейства~(\ref{eq:special}):
\begin{multline}\label{eq:special_transformed}
F_t(\Phi) = l_6(x_1, y_1, x_2, y_2, u, v) \cdot l_3(x_1, y_1, x_2, y_2, u, v) + k_1 l_1(x_1, y_1, x_2, y_2, u, v){}^2 + \\ + k_2 l_1(x_1, y_1, x_2, y_2, u, v)\cdot l_2(x_1, y_1, x_2, y_2, u, v) + k_3 l_2(x_1, y_1, x_2, y_2, u, v){}^2 - \\ 
- l_3(x_1, y_1, x_2, y_2, u, v) \left[\mu l_3(x_1, y_1, x_2, y_2, u, v){}^2+\nu  l_4(x_1, y_1, x_2, y_2, u, v){}^2\right]
\end{multline}

\item Производная~(\ref{eq:special_transformed}) по $t$ в точке $t = 0$:
\begin{multline}\label{eq:special_diff}
\left.\frac{\mathrm d}{\mathrm{d}t} F_t\left(\Phi\right)\right|_{t = 0} = v l_3^{\prime}(x_1, y_1, x_2, y_2, u, v) + x_2 l_6^{\prime}(x_1, y_1, x_2, y_2, u, v) + \\
+ 2 k_1 x_1 l_1^{\prime}(x_1, y_1, x_2, y_2, u, v) + k_2 y_1 l_2^{\prime}(x_1, y_1, x_2, y_2, u, v) + \\
+ k_2 x_1 l_2^{\prime}(x_1, y_1, x_2, y_2, u, v) +2 k_3 y_1 l_2^{\prime}(x_1, y_1, x_2, y_2, u, v) - \left(\mu x_2^2+\nu  y_2^2\right) \times \\
\times l_3^{\prime}(x_1, y_1, x_2, y_2, u, v) - x_2 \left[2 \mu  x_2 l_3^{\prime}(x_1, y_1, x_2, y_2, u, v) + \right. \\
\left. +2 \nu  y_2 l_4^{\prime}(x_1, y_1, x_2, y_2, u, v)\right]
\end{multline}

\item Разрешим уравнение~(\ref{eq:special}) относительно $v$:
$$
v = \frac{k_1 x_1^2 + k_2 x_1 y_1 + k_3 x_2^2}{x_2} +  \mu x_2^2 + \nu y_2^2
$$
и подставим его в~(\ref{eq:special_diff}), умножая на $x_2^2$. В данном многочлене имеется 57 мономов и 101 слагаемое. Приведем подобные и выпишем по одному примеру одночленов для каждой из степеней:
\begin{align*}
\text{степень 6}&:\ x_1 x_2^2 y_2 \left(k_2 \alpha _{2,1}-2 k_1 \alpha _{2,2}\right) \\
\text{степень 5}&:\ x_1 x_2^4 \left(-2 \mu  \beta _{1,1}+k_2 \mu  \alpha _{3,1}-2 k_1 \mu  \alpha _{3,2}\right) \\ 
\text{степень 4}&:\ x_1 x_2 y_1^2 \left(k_2^2 \alpha _{3,2}-3 k_3 k_2 \alpha _{3,1}+2 k_1 k_3 \alpha _{3,2}+k_2 \beta _{1,2}-k_3 \beta _{1,1}\right) \\
\text{степень 3}&:\ x_2^3 \sigma _{3,2}
\end{align*}
Видно, что есть как довольно простые (степень 3), так и довольно сложные (степень 4) коэффициенты при одночленах.

\item Составим однородную систему линейных уравнений на основе многочлена, полученного в предыдущем пункт. Получается система из 57 уравнений относительно 24 неизвестных. Схему основной матрицы этой системы можно посмотреть в приложении 3. 

В качестве примеров, приведем некоторые уравнения из этой системы:
\begin{equation}
\begin{aligned}
k_2^2 \left(-\alpha _{3,1}\right)+3 k_1 k_2 \alpha _{3,2}-2 k_1 k_3 \alpha _{3,1}-k_2 \beta _{1,1}+k_1 \beta _{1,2} &= 0 \\
2 k_2 \alpha _{1,1}-2 k_1 \alpha _{1,2}+2 k_3 \alpha _{1,2}-k_2 \beta _{2,1}-k_2 \gamma _{3,1} &=0 \\
-2 \mu  \beta _{1,1}+k_2 \mu  \alpha _{3,1}-2 k_1 \mu  \alpha _{3,2} &= 0 \\
\left(k_2^2 + 2 k_1 k_3\right) \beta _{3,2} &=0 \\ 
k_2 \alpha _{2,1}-2 k_1 \alpha _{2,2} &= 0 \\
\gamma_{3,2} &= 0
\end{aligned}
\end{equation}
\item Для изучения ранга этой матрицы, приведем её элементарными преобразованиями к ступенчатому виду.
\end{enumerate}

Предположим, что $k_1 \ne 0$. В таком случае, мы можем сделать замену переменных $z^*_1 = z_1
/ \sqrt k_1$, и замену параметров $k^*_2 = k_2 / k_1$, $k^*_3 = k_3 / k_1$, чтобы избавиться от параметра $k_1$ в уравнении поверхности, а значит, и в системе уравнений. Теперь мы можем привести матрицу системы $W$ к следующему квазитреугольному виду:
\begin{equation*}
W \sim
\begin{pmatrix}
A & N \\
0 & B \\
\hdots & \hdots  \\
0 & 0
\end{pmatrix},
\end{equation*}
где матрица $A$ "--- диагональная матрица размерами $14\times14$, $N\in \mathbb{R}^{14\times10}$, $B \in \mathbb{R}^{15\times10}$ и имеет вид (символы ${}^*$ при параметрах $k_2$ и $k_3$ опущены):
\begin{equation}\label{eq:aux_matrix}
{\small\left(
\begin{array}{cccccccccc}
 0 & -\nu  \left(k_2^2-4 k_3\right) & 0 & 0 & 0 & 0 & \nu  k_2 & 0 & 0 & 0 \\
 0 & 0 & 0 & k_2^2-2 k_3+2 & 0 & 0 & 0 & 0 & 0 & 0 \\
 0 & 0 & 0 & 0 & 0 & 0 & -\nu  & 0 & 0 & 0 \\
 0 & 0 & 0 & 0 & \frac{1}{2} \left(k_2^2+4\right) & 0 & 0 & 0 & 0 & -\frac{k_2}{2} \\
 0 & -\frac{1}{2} \left(k_2^2+4\right) & 0 & 0 & 0 & 0 & \frac{k_2}{2} & 0 & 0 & 0 \\
 4 \mu  & 0 & 3 \mu  & 2 \mu  k_2 & 0 & 0 & 0 & 0 & 0 & 0 \\
 0 & \frac{3}{2} \mu  \left(k_2^2-4 k_3\right) & 0 & 0 & 0 & 0 & -\frac{3 \mu  k_2}{2} & 0 & 0 & 0 \\
 0 & 0 & 0 & 0 & 0 & 0 & -2 \nu  & 0 & 0 & 0 \\
 4 \nu  & 0 & 3 \nu  & 2 \nu  k_2 & 0 & 0 & 0 & 0 & 0 & 0 \\
 0 & 0 & 0 & 0 & 0 & 0 & -3 \mu  & 0 & 0 & 0 \\
 0 & 0 & 0 & k_2 \left(k_3+1\right) & 0 & 0 & 0 & 0 & 0 & 0 \\
 0 & \frac{1}{2} \nu  \left(k_2^2-4 k_3\right) & 0 & 0 & 0 & 0 & -\frac{\nu  k_2}{2} & 0 & 0 & 0 \\
 0 & 0 & 0 & 0 & k_2 \left(k_3+1\right) & 0 & 0 & 0 & 0 & -k_3 \\
 0 & -k_2 \left(k_3+1\right) & 0 & 0 & 0 & 0 & k_3 & 0 & 0 & 0 \\
 0 & 0 & 0 & 0 & 0 & \frac{1}{2} \left(k_2^2-4 k_3\right) & 0 & 0 & 0 & 0 \\
\end{array}
\right)}.
\end{equation}

Очевидно, что $\mathrm{rank}~W = \mathrm{rank}~A + \mathrm{rank}~B$. Так как матрица $A$ является диагональной, то $\mathrm{rank}~W = 14 + \mathrm{rank}~B$. В таком случае, найдем ранг матрицы $B$, приведя её к ступенчатому виду. 

Из~(\ref{eq:aux_matrix}) видно, что в матрице $B$ существуют независимые столбцы с заведомо ненулевыми элементами. Это, во-первых, столбцы 2 и 5 с элементами вида $k_2^2 + 4$, и, во-вторых, столбцы 7 и 1 (или 3) с элементами $\mu$ и $\nu$. Таким образом, ранг матрицы $B$ не меньше четыркх. Пусть далее $\mu \ne 0$ (случай $\nu \ne 0$ рассматривается по аналогии). 

Далее, придется рассмотреть два случая "--- когда $k_2 = 0$ и $k_2 \ne 0$. В первом случае, матрица $B$ приводится к виду
\begin{equation*} 
\left(
\begin{array}{cccccccccc}
 2 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
 0 & -2 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
 0 & 0 & 3 \mu  & 0 & 0 & 0 & 0 & 0 & 0 & 4 \mu  \\
 0 & 0 & 0 & -3 \mu  & 0 & 0 & 0 & 0 & 0 & 0 \\
 0 & 0 & 0 & 0 & -2 k_3 & 0 & 0 & 0 & 0 & 0 \\
 0 & 0 & 0 & 0 & 0 & -k_3 & 0 & 0 & 0 & 0 \\
 0 & 0 & 0 & 0 & 0 & 0 & -2 \left(k_3-1\right) & 0 & 0 & 0 \\
   &   &   &   &   & \hdots &   &   &   &   \\
 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
\end{array}
\right).
\end{equation*} 
Очевидно, что ранг матрицы $B$ будет равен 5 при $k_3 = 0$, 6 при $k_3 = 1$ и 7 в ином случае. Таким образом, ранг матрицы $W$ будет равен 19, 20 и 21 соответственно, а размерность соответствующей группы преобразований, как видно из~(\ref{eq:dim_rank}), равна 5, 4 и 3.

В случае, когда $k_2 \ne 0$, матрица $B$ приобретает следующий вид:
\begin{equation*}
{\small\left(
\begin{array}{cccccccccc}
 \frac{1}{2} \left(k_2^2+4\right) & 0 & 0 & 0 & -\frac{k_2}{2} & 0 & 0 & 0 & 0 & 0 \\
 0 & \frac{1}{2} \left(-k_2^2-4\right) & 0 & \frac{k_2}{2} & 0 & 0 & 0 & 0 & 0 & 0 \\
 0 & 0 & 3 \mu  & 0 & 0 & 0 & 2 \mu  k_2 & 0 & 0 & 4 \mu  \\
 0 & 0 & 0 & -3 \mu  & 0 & 0 & 0 & 0 & 0 & 0 \\
 0 & 0 & 0 & 0 & \frac{k_2^2 - 4 k_3}{k_2^2+4} & 0 & 0 & 0 & 0 & 0 \\
 0 & 0 & 0 & 0 & 0 & \frac{1}{2} \left(k_2^2-4 k_3\right) & 0 & 0 & 0 & 0 \\
 0 & 0 & 0 & 0 & 0 & 0 & k_2 \left(k_3+1\right) & 0 & 0 & 0 \\
 0 & 0 & 0 & 0 & 0 & 0 & k_2^2-2 k_3+2 & 0 & 0 & 0 \\
   &   &   &   &   & \hdots &   &   &   &   \\
 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 \\
\end{array}
\right)}
\end{equation*}
Отсюда видно, что ранг матрицы $B$ равен 5 при $k_2 = 2\sqrt{k_3},~k_3 > 0$ и 7 в иных случаях, что означает размерности 5 и 3 у групп аффинных преобразований, сохраняющих соответствующие поверхности.

Таким образом, для случая $k_1 \ne 0$ возможна следующая классификация поверхностей по размерности группы преобразований, сохраняющих эти поверхности:
\begin{itemize}
\item $\dim G = 5$ соответствуют поверхности
\begin{gather}
	v x_2 = x_1^2 + x_2 (\mu x_2^2 + \nu y_2^2),\label{eq:surf_1} \\
	v x_2 = (x_1 + y_1 \sqrt{k_3})^2 + x_2 (\mu x_2^2 + \nu y_2^2),~(k_3 > 0);\label{eq:surf_2}
\end{gather}
\item $\dim G = 4$ соответствуют поверхности
\begin{gather}
	v x_2 = x_1^2 + y_1^2 + x_2 (\mu x_2^2 + \nu y_2^2);
\end{gather}
\item $\dim G = 3$ соответствуют поверхности
\begin{gather}
	v x_2 = x_1^2 + k_2 x_1 y_1 + k_3 y_1^2 + x_2 (\mu x_2^2 + \nu y_2^2),~(k_2 \ne 2\sqrt{k_3}, k_3 \ne 1)
\end{gather}
\end{itemize}
Заметим, что поверхности~(\ref{eq:surf_1}) и~(\ref{eq:surf_2}) являются аффинно-эквивалентными. Действительно, произведя замену переменных $z^*_1 = (1+i)/(a^2+1)z_1$ в уравнении~(\ref{eq:surf_2}), получаем поверхность~(\ref{eq:surf_1}).

Проводя аналогичные рассуждения для параметров $k_2$ и $k_3$, получаем следующие размерности для поверхностей:
% k_2 \ne 0:
% \dim G = 3: v x_2 = k_1 x_1^2+ x_1 x_2 - k_1 y_1 ^2 + ...
%             v x_2 = x_1 x_2 + ... 
% \dim G = 5: v x_2 = 

Исходя их этих соображений, можно сформулировать следующую теорему:
\begin{theorem}\label{thm:special} размерность группы Ли аффинных преобразований, сохраняющих любую поверхность вида~(\ref{eq:special}), удовлетворяет неравенствам
$3 \le \dim G \le 5$, причем
\begin{itemize}
	\item $\dim G$ = 3 достигается на поверхностях вида
	\begin{equation}\label{eq:special_3}
		v x_2 = x_1^2 + k y_1^2 + x_2 (\mu x_2^2 + \nu y_2^2),\ k \ne 0, \ k \ne 1;
	\end{equation}
	\item $\dim G$ = 4 достигается на поверхностях вида
	\begin{equation}\label{eq:special_4}
		v x_2 = |z_1|^2 + x_2 (\mu x_2^2 + \nu y_2^2);
	\end{equation}
		\item $\dim G$ = 5 достигается на аффинно-однородных поверхностях следующего вида
	\begin{equation}\label{eq:special_5}
		v x_2 = x_1^2 + x_2 (\mu x_2^2 + \nu y_2^2).
	\end{equation}
\end{itemize}
\end{theorem}

Рассмотрим движения, которые сохраняют классы поверхностей, перечисленных в теореме~\ref{thm:special}. Для этого решим возникающие системы уравнений для каждого из случаев, чтобы получить инфинитезимальные преобразования, порождающие однопараметрические группы аффинных преобразований, сохраняющих поверхности из обозначенных случаев.

Для каждой поверхности из класса~(\ref{eq:special}) существуют три <<основных>> движения, сохраняющие эти поверхности. Инфинитезимальные преобразования, порождающие группу движений, имеют следующий вид:
\begin{gather}
E_1 = 
\left(
\begin{array}{cccc}
 -\frac{3}{2} & 0 & 0 & 0 \\
 0 & 1 & 0 & 0 \\
 0 & 0 & 2 & 0 \\
\end{array}
\right),~
E_2 = 
\left(
\begin{array}{cccc}
 0 & 0 & 0 & 0 \\
 0 & 0 & 0 & i \\
 0 & 2 \nu  & 0 & 0 \\
\end{array}
\right), \nonumber\\
E_3 = 
\left(
\begin{array}{cccc}
 0 & 0 & 0 & 0 \\
 0 & 0 & 0 & 0 \\
 0 & 0 & 0 & 1 \\
\end{array}
\right).
\end{gather}
Рассмотрим соответствующие аффинные преобразования:
\begin{itemize}
\item \textit{сдвиг} по переменной $u$. 
\item \textit{масштабирование}: 
\item \textit{поворот со сдвигом (<<скользящий поворот>>)}:
\end{itemize}

Для поверхностей типа~(\ref{eq:special_4}) добавляется еще один вид движения "--- повороты в плоскости $z_1$. 

Поверхности~(\ref{eq:special_5}), в дополнение к трем основным, имеют еще два типа движений:
\begin{itemize}
\item \textit{сдвиг} по переменной $y_1$.
\item \textit{поворот}:
\end{itemize}

%%%%%%%
\subsection{Произвольная поверхность}
В общем случае, квадратичную форму $Q(x_1, y_1, x_2, y_2)$ можно записать в явном виде:
\begin{align*}
Q(x_1, y_1, x_2, y_2) &= k_1 x_1^2 + k_2 x_2 x_1 + k_3 x_2^2 + k_4 x_1 y_1 + k_5 x_2 y_1 \\
&+ k_6 y_1^2 + k_7 x_1 y_2 + k_8 x_2 y_2 + k_9 y_1 y_2 + k_{10} y_2^2
\end{align*}

Применяя метод, указанный в предыдущем пункте, получим линейную однородную систему из 83 уравнений относительно 24 неизвестных, причем переменная $\sigma_{3,1}$ является <<фиктивной>> "--- в связи с тем, что   Наиболее простые уравнения в системе имеют вид
\begin{equation}
\begin{matrix}
 k_1 \beta _{3,2}=0 &  k_1 \beta _{3,1}=0 &  k_1 \sigma _{2,1}=0 \\
 k_6 \beta _{3,2}=0 & k_6 \beta _{3,1}=0 & k_6 \sigma _{2,1}=0 \\
 k_4 \beta _{3,1}=0 &  k_4 \sigma _{2,1}=0 \\
 k_7 \sigma _{2,1}=0 & k_7 \beta _{3,1}=0 \\
 k_9 \beta _{3,1}=0 & k_9 \sigma _{2,1}=0 \\
 k_{10} \beta _{3,2}=0 &  & 
\end{matrix}
\end{equation}
Отсюда можно выделить два случая:
\begin{enumerate}
	\item Все $k_j$ равны нулю: $k_1 = k_4 = k_6 = k_7 = k_9 = k_{10} = 0$.
	\item Хотя бы один $k_j$ из указанного набора не равен нулю.
\end{enumerate}
В первом случае поверхность приобретает следующий вид:
\begin{equation*}
v x_2 = k_2 x_2 x_1 + k_3 x_2^2 + k_5 x_2 y_1 + k_8 x_2 y_2 + x_2 (\mu x_2^2 + \nu y_2^2).
\end{equation*}
Легко видеть, что данное уравнение можно поделить на $x_2$, что в итоге даст новую поверхность, которая является квадрикой. Рассмотрение поверхностей данного типа не представляет интереса в данной работе, поэтому можно сразу перейти к рассмотрению второго случая.

Предположим, что $k_1 \ne 0 $. В таком случае, приведем элементарными преобразованиями матрицу системы $W$ к ступенчатому виду.

Исходя их этих соображений можно сформулировать следующую теорему:

\begin{theorem} Размерность группы Ли аффинных преобразований, сохраняющих любую поверхность из семейства~(\ref{eq:initial}), удовлетворяет неравенству $1 \le \dim G \le 5$, и каждая из размерностей достижима.
\end{theorem}

\end{document}