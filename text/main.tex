% XeLaTeX can use any Mac OS X font. See the setromanfont command below.
% Input to XeLaTeX is full Unicode, so Unicode characters can be typed directly into the source.

% The next lines tell TeXShop to typeset with xelatex, and to open and save the source with Unicode encoding.

%!TEX TS-program = xelatex
%!TEX encoding = UTF-8 Unicode


\documentclass[a4paper,14pt]{extarticle}
\usepackage{geometry}
\geometry{a4paper}                   % ... or a4paper or a5paper or ...
%\geometry{landscape}                % Activate for for rotated page geometry
\setlength{\parindent}{15mm}
%\renewcommand{\baselinestretch}{1.5}
%\usepackage[parfill]{parskip}    % Activate to begin paragraphs with an empty line rather than an indent
\usepackage{graphicx}
\usepackage{amsmath, amssymb, amsthm, mathtools}
\newtheorem{proposal}{Предложение}
\newtheorem{theorem}{Теорема}
\newtheorem{lemma}{Лемма}
\newtheorem{theorem_alt}{Теорема (альтернативная формулировка)}
\newtheorem{consequence}{Следствие}
\usepackage{fontspec,xltxtra,xunicode}
\usepackage{csquotes}
\usepackage{tocloft}
\renewcommand{\cftsecleader}{\cftdotfill{\cftdotsep}}
%\defaultfontfeatures{Ligatures=TeX}

\usepackage[titletoc, title]{appendix}
\renewcommand{\appendixtocname}{Приложения}
\renewcommand{\appendixname}{Приложение}

\defaultfontfeatures{Mapping=tex-text}
\setmainfont{CMU Serif}
\setsansfont{CMU Sans Serif}
\setmonofont{CMU Typewriter Text}

%\usepackage[english, russian]{babel}
\usepackage{polyglossia}
\setmainlanguage{russian}
\setotherlanguage{english}
\setkeys{russian}{babelshorthands=true}

\newcommand{\sectionbreak}{\clearpage}
\usepackage{titlesec}
\usepackage{indentfirst}
\usepackage{setspace}
\onehalfspacing
\usepackage{titlesec}
\titleformat*{\section}{\Large\bfseries\centering}
\titleformat*{\subsection}{\large\bfseries\centering}

\usepackage{listings} 
\lstset{ 
language=[5.2]Mathematica, 
morekeywords={Solve, Evaluate}, 
breaklines=true, 
extendedchars=\true, 
inputencoding=utf8, 
tabsize=2, 
escapeinside={\%}{\%}, 
basicstyle=\small\ttfamily,
keywordstyle=\textbf
}

\usepackage{csquotes}
%\usepackage[
%	style=gost-numeric,
%	bibencoding=utf8,
%	language=auto,
%	autolang=other,
%	sorting=none,
%	backend=biber,
%	bibencoding=utf8,
%	isbn=false,
%	sortcites=true,
%	clearlang=true,
%	language=autobib,
%	defernumbers=true,
%]{biblatex}
%\addbibresource{../bib_files/bibliography.bib}

\numberwithin{equation}{section}
\usepackage{subfiles}

% Will Robertson's fontspec.sty can be used to simplify font choices.
% To experiment, open /Applications/Font Book to examine the fonts provided on Mac OS X,
% and change "Hoefler Text" to any of these choices.
%\setromanfont[Mapping=tex-text]{Times New Roman}
%\setsansfont[Scale=MatchLowercase,Mapping=tex-text]{Gill Sans}
%\setmonofont[Scale=MatchLowercase]{Courier New}

%\title{Brief Article}
%\author{The Author}
%\date{}                                      % Activate to display a given date or no date

\newcommand{\RN}[1]{%
  \textup{\uppercase\expandafter{\romannumeral#1}}%
}

\begin{document}
\newgeometry{margin=2cm}
\begin{titlepage}
\subfile{sections/titlepage}
\end{titlepage}

%% ЗАДАНИЕ НА ВЫПОЛНЕНИЕ
\newpage\thispagestyle{empty}
\addtocounter{page}{1}
\subfile{sections/useless_page}

%% РЕФЕРАТ
\subfile{sections/abstract}

\newgeometry{top=15mm, left=30mm, right=15mm, bottom=20mm}
\tableofcontents
%\maketitle

%% ВВЕДЕНИЕ
\addcontentsline{toc}{section}{Введение}
\section*{\centering Введение}
\subfile{sections/introduction}

%%% ПОСТАНОВКА ЗАДАЧИ
\section{Постановка задачи}
\subfile{sections/first_chapter}

%%% ТЕОРЕТИЧЕСКАЯ ЧАСТЬ
\section{Симметрии в трехмерном комплексном пространстве}
\subfile{sections/second_chapter}

%%% ЭКСПЕРИМЕНТАЛЬНАЯ ЧАСТЬ
\section{Определение размерности групп аффинных преобразований}
\subfile{sections/third_chapter}

%%% КОМПЬЮТЕРНЫЕ АЛГОРИТМЫ
\section{Компьютерные алгоритмы}
\subfile{sections/fourth_chapter}

%%% ЗАКЛЮЧЕНИЕ
\addcontentsline{toc}{section}{Заключение}
\section*{\centering Заключение}
\subfile{sections/conclusion}

%%% СПИСОК ЛИТЕРАТУРЫ
\addcontentsline{toc}{section}{Список использованных источников}
%\printbibliography
\bibliography{../bib_files/bibliography}
\bibliographystyle{ugost2003}

%%% ПРИЛОЖЕНИЕ
\begin{appendices}
\renewcommand{\thesection}{\Asbuk{section}}
\titleformat{\section}[display]
    {\centering\normalfont\Large\bfseries}{\appendixname\enspace\thesection}{.5em}{}
\addtocontents{toc}{\protect\setcounter{tocdepth}{1}}

\section{Используемые выражения}
\subfile{sections/appendix_one}

\section{Листинг программы}
\subfile{sections/appendix_two}

\section{Схема матрицы в частном случае}
\subfile{sections/appendix_three}

\section{Схема матрицы в общем случае}
\subfile{sections/appendix_four}

\end{appendices}

\end{document}